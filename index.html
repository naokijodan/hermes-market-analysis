<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HERMES å¸‚å ´åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        :root {
            --primary: #FF6B00;
            --primary-dark: #E65100;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --bg-card-hover: #1f2b4d;
            --text: #eee;
            --text-muted: #aaa;
            --border: #333;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #f44336;
        }

        [data-theme="light"] {
            --bg-dark: #f5f5f5;
            --bg-card: #fff;
            --bg-card-hover: #f9f9f9;
            --text: #333;
            --text-muted: #666;
            --border: #ddd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle {
            background: rgba(255,255,255,0.2);
            border: none;
            color: #fff;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 5px;
            background: var(--bg-card);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: var(--bg-card-hover);
            color: var(--text);
        }

        .tab-btn.active {
            background: var(--primary);
            color: #fff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 13px;
            margin-top: 5px;
        }

        /* Charts */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .chart-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .chart-container {
            height: 400px;
        }

        /* Tables */
        .table-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .search-box {
            padding: 8px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-dark);
            color: var(--text);
            width: 250px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-dark);
            font-weight: 600;
            position: sticky;
            top: 0;
            cursor: pointer;
        }

        th:hover {
            background: var(--bg-card-hover);
        }

        tr:hover {
            background: var(--bg-card-hover);
        }

        .price {
            color: var(--success);
            font-weight: 600;
        }

        .count-badge {
            background: var(--primary);
            color: #fff;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
        }

        .search-link {
            color: var(--primary);
            text-decoration: none;
            font-size: 12px;
            padding: 3px 8px;
            border: 1px solid var(--primary);
            border-radius: 4px;
            margin-left: 5px;
        }

        .search-link:hover {
            background: var(--primary);
            color: #fff;
        }

        .search-checkbox {
            margin-left: 5px;
            margin-right: 10px;
            cursor: pointer;
            width: 16px;
            height: 16px;
            vertical-align: middle;
        }


        /* Insights */
        .insights-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid var(--primary);
            border: 1px solid var(--border);
            border-left: 4px solid var(--primary);
        }

        .insights-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .insight-item {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
            color: var(--text);
        }

        .insight-item::before {
            content: "â€¢";
            color: var(--primary);
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
            font-size: 12px;
            border-top: 1px solid var(--border);
            margin-top: 30px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>HERMES å¸‚å ´åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</h1>
        <div class="header-controls">
            <span id="dataInfo">ãƒ‡ãƒ¼ã‚¿æœŸé–“: 2026-01-22 | ç·ä»¶æ•°: 9,735ä»¶</span>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</button>
        </div>
    </div>

    <div class="container">
        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="overview">ğŸ“Š å…¨ä½“åˆ†æ</button>
            <button class="tab-btn" data-tab="scarf">ğŸ§£ ã‚¹ã‚«ãƒ¼ãƒ•</button>
            <button class="tab-btn" data-tab="bag">ğŸ‘œ ãƒãƒƒã‚°</button>
            <button class="tab-btn" data-tab="accessory">ğŸ’ ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼</button>
            <button class="tab-btn" data-tab="leather">ğŸ’¼ è²¡å¸ƒãƒ»é©å°ç‰©</button>
            <button class="tab-btn" data-tab="parts">ğŸ“¦ ä»˜å±å“</button>
            <button class="tab-btn" data-tab="other">ğŸ“Œ ãã®ä»–</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“¦</div>
                    <div class="stat-value">9,735</div>
                    <div class="stat-label">ç·è²©å£²ä»¶æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$2,744,406</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-value">$282</div>
                    <div class="stat-label">å¹³å‡ä¾¡æ ¼</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ§£</div>
                    <div class="stat-value">55.8%</div>
                    <div class="stat-label">ã‚¹ã‚«ãƒ¼ãƒ•æ¯”ç‡</div>
                </div>
            </div>

            <div class="insights-card">
                <div class="insights-title">ğŸ’¡ ãƒãƒ¼ã‚±ãƒƒãƒˆã‚¤ãƒ³ã‚µã‚¤ãƒˆ</div>
                <div class="insight-item"><strong>ã‚¹ã‚«ãƒ¼ãƒ•ãŒä¸»åŠ›å•†å“:</strong> å…¨ä½“ã®55.8%ï¼ˆ5,430ä»¶ï¼‰ã‚’å ã‚ã€ç·å£²ä¸Š$925,813ã‚’è¨˜éŒ²</div>
                <div class="insight-item"><strong>ã‚«ãƒ¬90ãŒåœ§å€’çš„äººæ°—:</strong> ã‚¹ã‚«ãƒ¼ãƒ•å†…ã§53.2%ï¼ˆ2,886ä»¶ï¼‰ã€ä¸­å¤®å€¤$128.5</div>
                <div class="insight-item"><strong>Brides de GalaãŒæœ€äººæ°—æŸ„:</strong> 183ä»¶ã§æŸ„åˆ¥ãƒˆãƒƒãƒ—ã€‚ãŸã ã—ä¸­å¤®å€¤$76ã¨æ‰‹é ƒãªä¾¡æ ¼å¸¯</div>
                <div class="insight-item"><strong>é«˜å˜ä¾¡ã‚«ãƒ†ã‚´ãƒª:</strong> ãƒãƒƒã‚°ï¼ˆå¹³å‡$898ï¼‰ã€ç‰¹ã«ãƒãƒ¼ã‚­ãƒ³ï¼ˆä¸­å¤®å€¤$7,722ï¼‰ãŒé«˜åç›Š</div>
                <div class="insight-item"><strong>ä»˜å±å“å¸‚å ´ã®å­˜åœ¨:</strong> ç©ºç®±ã‚„ãƒ€ã‚¹ãƒˆãƒãƒƒã‚°ã ã‘ã§350ä»¶ã€å¹³å‡$159ã§å–å¼•</div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ã‚«ãƒ†ã‚´ãƒªåˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-category-count"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’° ã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Šæ§‹æˆ</div>
                    <div class="chart-container" id="chart-category-sales"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ä¾¡æ ¼å¸¯åˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-price-dist"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ¨ ç´ æåˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-material"></div>
                </div>
            </div>

            <!-- Category Summary Table -->
            <div class="table-container">
                <div class="table-header">
                    <h3>ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒãƒªãƒ¼</h3>
                </div>
                <table id="table-category">
                    <thead>
                        <tr>
                            <th>ã‚«ãƒ†ã‚´ãƒª</th>
                            <th>ä»¶æ•°</th>
                            <th>ç·å£²ä¸Š</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Scarf Tab -->
        <div id="scarf" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ§£</div>
                    <div class="stat-value">5,430</div>
                    <div class="stat-label">ã‚¹ã‚«ãƒ¼ãƒ•è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$925,813</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$113.5</div>
                    <div class="stat-label">ä¸­å¤®å€¤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¨</div>
                    <div class="stat-value">22</div>
                    <div class="stat-label">è­˜åˆ¥æŸ„æ•°</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“ ã‚µã‚¤ã‚ºåˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-scarf-size"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ¨ æŸ„åˆ¥è²©å£²æ•°ï¼ˆTop15ï¼‰</div>
                    <div class="chart-container" id="chart-scarf-pattern"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ã‚µã‚¤ã‚ºåˆ¥ä¾¡æ ¼æ¯”è¼ƒ</div>
                    <div class="chart-container" id="chart-scarf-price"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ”¥ ã‚µã‚¤ã‚ºÃ—æŸ„ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</div>
                    <div class="chart-container" id="chart-scarf-heatmap"></div>
                </div>
            </div>

            <!-- Scarf Pattern Table -->
            <div class="table-container">
                <div class="table-header">
                    <h3>æŸ„åˆ¥è©³ç´°</h3>
                    <input type="text" class="search-box" placeholder="æŸ„åã§æ¤œç´¢..." onkeyup="filterTable('table-scarf-pattern', this.value)">
                </div>
                <table id="table-scarf-pattern">
                    <thead>
                        <tr>
                            <th onclick="sortTable('table-scarf-pattern', 0)">æŸ„å</th>
                            <th onclick="sortTable('table-scarf-pattern', 1)">ä»¶æ•°</th>
                            <th onclick="sortTable('table-scarf-pattern', 2)">å¹³å‡ä¾¡æ ¼</th>
                            <th onclick="sortTable('table-scarf-pattern', 3)">ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Animal Pattern Section -->
            <div class="insights-card" style="margin-top: 25px;">
                <div class="insights-title">ğŸ¦ ã‚¢ãƒ‹ãƒãƒ«æŸ„åˆ†æï¼ˆå…¨451ä»¶ / ã‚¹ã‚«ãƒ¼ãƒ•å…¨ä½“ã®7.9%ï¼‰</div>
                <div class="insight-item"><strong>é¦¬æŸ„ãŒæœ€å¤š:</strong> 244ä»¶ï¼ˆ54%ï¼‰- ã‚¨ãƒ«ãƒ¡ã‚¹ã®é¦¬å…·ãƒ–ãƒ©ãƒ³ãƒ‰ã¨ã—ã¦ã®æ­´å²ã‚’åæ˜ </div>
                <div class="insight-item"><strong>é«˜ä¾¡æ ¼å¸¯:</strong> ãƒ¬ã‚ªãƒ‘ãƒ¼ãƒ‰$390ã€è±¡$464ã€è™$307ãŒé«˜ä¸­å¤®å€¤</div>
                <div class="insight-item"><strong>Jungle Loveäººæ°—:</strong> ãƒ„ã‚¤ãƒªãƒ¼ã§ç‰¹ã«äººæ°—ï¼ˆ12ä»¶ï¼‰ã€ä¸­å¤®å€¤$166</div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ¦ ã‚¢ãƒ‹ãƒãƒ«æŸ„åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-animal-pattern"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ã‚¢ãƒ‹ãƒãƒ«æŸ„åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-animal-price"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card" style="grid-column: span 2;">
                    <div class="chart-title">ğŸ”¥ ã‚µã‚¤ã‚ºÃ—ã‚¢ãƒ‹ãƒãƒ«æŸ„ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</div>
                    <div class="chart-container" id="chart-animal-heatmap" style="height: 450px;"></div>
                </div>
            </div>

            <!-- Animal Pattern Table -->
            <div class="table-container" style="margin-top: 15px;">
                <div class="table-header">
                    <h3>ã‚¢ãƒ‹ãƒãƒ«æŸ„è©³ç´°</h3>
                </div>
                <table id="table-animal-pattern">
                    <thead>
                        <tr>
                            <th>æŸ„å</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Bag Tab -->
        <div id="bag" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘œ</div>
                    <div class="stat-value">918</div>
                    <div class="stat-label">ãƒãƒƒã‚°è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$824,341</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$898</div>
                    <div class="stat-label">å¹³å‡ä¾¡æ ¼</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘‘</div>
                    <div class="stat-value">$7,722</div>
                    <div class="stat-label">ãƒãƒ¼ã‚­ãƒ³ä¸­å¤®å€¤</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ãƒ¢ãƒ‡ãƒ«åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-bag-model"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ãƒ¢ãƒ‡ãƒ«åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-bag-price"></div>
                </div>
            </div>

            <!-- Bag Model Table -->
            <div class="table-container">
                <div class="table-header">
                    <h3>ãƒ¢ãƒ‡ãƒ«åˆ¥è©³ç´°</h3>
                </div>
                <table id="table-bag-model">
                    <thead>
                        <tr>
                            <th>ãƒ¢ãƒ‡ãƒ«</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æœ€ä½ä¾¡æ ¼</th>
                            <th>æœ€é«˜ä¾¡æ ¼</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Accessory Tab -->
        <div id="accessory" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’</div>
                    <div class="stat-value">1,149</div>
                    <div class="stat-label">ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$289,487</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$171</div>
                    <div class="stat-label">ä¸­å¤®å€¤</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ç¨®é¡åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-accessory-type"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ç¨®é¡åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-accessory-price"></div>
                </div>
            </div>

            <!-- ç´°åˆ†åŒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="insights-card" style="margin-bottom: 25px;">
                <div class="insights-title">ğŸ’ ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼è©³ç´°åˆ†æï¼ˆ1,498ä»¶ â†’ 41ã‚¿ã‚¤ãƒ—ã«ç´°åˆ†åŒ–ï¼‰</div>
                <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 15px;">
                    ãƒãƒ³ã‚°ãƒ«ï¼ˆ10ç¨®ï¼‰ã€ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚°ï¼ˆ7ç¨®ï¼‰ã€ã‚«ãƒ‡ãƒŠ/ãƒãƒ£ãƒ¼ãƒ ï¼ˆ5ç¨®ï¼‰ã€ãƒ™ãƒ«ãƒˆï¼ˆ5ç¨®ï¼‰ã€ãƒãƒƒã‚¯ãƒ¬ã‚¹ï¼ˆ5ç¨®ï¼‰ãªã©è©³ç´°åˆ†é¡
                </p>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—åˆ¥è²©å£²æ•°ï¼ˆä¸Šä½20ï¼‰</div>
                    <div class="chart-container" id="chart-accessory-detail-type" style="height: 500px;"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ¨ ç´ æåˆ¥åˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-accessory-material"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card" style="grid-column: 1 / -1;">
                    <div class="chart-title">ğŸ”¥ ã‚¿ã‚¤ãƒ— Ã— ç´ æ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆä»¶æ•°ï¼‰</div>
                    <div class="chart-container" id="chart-accessory-heatmap" style="height: 550px;"></div>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header">
                    <h3>ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—è©³ç´°ï¼ˆ41ã‚¿ã‚¤ãƒ—ï¼‰</h3>
                    <input type="text" id="search-accessory-type" class="search-input" placeholder="ã‚¿ã‚¤ãƒ—åã§æ¤œç´¢...">
                </div>
                <table id="table-accessory-detail">
                    <thead>
                        <tr>
                            <th>ã‚¿ã‚¤ãƒ—</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æœ€ä½</th>
                            <th>æœ€é«˜</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="table-container" style="margin-top: 25px;">
                <div class="table-header">
                    <h3>ã‚¿ã‚¤ãƒ— Ã— ç´ æ çµ„ã¿åˆã‚ã›ï¼ˆä»¶æ•°3ä»¥ä¸Šï¼‰</h3>
                </div>
                <table id="table-accessory-cross">
                    <thead>
                        <tr>
                            <th>ã‚¿ã‚¤ãƒ—</th>
                            <th>ç´ æ</th>
                            <th>ä»¶æ•°</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="table-container" style="margin-top: 25px;">
                <div class="table-header">
                    <h3>æ±ç”¨ã‚«ãƒ†ã‚´ãƒªåˆ¥ï¼ˆå¾“æ¥åˆ†é¡ï¼‰</h3>
                </div>
                <table id="table-accessory">
                    <thead>
                        <tr>
                            <th>ç¨®é¡</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Bangle Detail -->
            <div class="chart-grid" style="margin-top: 25px;">
                <div class="chart-card">
                    <div class="chart-title">ğŸ’ ãƒãƒ³ã‚°ãƒ«ç´ æåˆ¥åˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-bangle-material"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ”— ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚° ãƒ¢ãƒ‡ãƒ«åˆ¥</div>
                    <div class="chart-container" id="chart-scarf-ring-model"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ‘” ãƒã‚¯ã‚¿ã‚¤æŸ„åˆ¥åˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-tie-pattern"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ãƒã‚¯ã‚¿ã‚¤æŸ„åˆ¥ä¾¡æ ¼</div>
                    <div class="chart-container" id="chart-tie-price"></div>
                </div>
            </div>

            <!-- Bangle Table -->
            <div class="table-container" style="margin-top: 25px;">
                <div class="table-header">
                    <h3>ãƒãƒ³ã‚°ãƒ«ç´ æåˆ¥è©³ç´°</h3>
                </div>
                <table id="table-bangle-material">
                    <thead>
                        <tr>
                            <th>ç´ æ</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Scarf Ring Table -->
            <div class="table-container" style="margin-top: 15px;">
                <div class="table-header">
                    <h3>ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚° ãƒ¢ãƒ‡ãƒ«åˆ¥è©³ç´°</h3>
                </div>
                <table id="table-scarf-ring">
                    <thead>
                        <tr>
                            <th>ãƒ¢ãƒ‡ãƒ«</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Tie Table -->
            <div class="table-container" style="margin-top: 15px;">
                <div class="table-header">
                    <h3>ãƒã‚¯ã‚¿ã‚¤æŸ„åˆ¥è©³ç´°</h3>
                </div>
                <table id="table-tie-pattern">
                    <thead>
                        <tr>
                            <th>æŸ„/ãƒ¢ãƒãƒ¼ãƒ•</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Leather Goods Tab -->
        <div id="leather" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’¼</div>
                    <div class="stat-value">777</div>
                    <div class="stat-label">è²¡å¸ƒãƒ»é©å°ç‰©è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$113,232</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$100</div>
                    <div class="stat-label">ä¸­å¤®å€¤</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ç¨®é¡åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-leather-type"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ç¨®é¡åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-leather-price"></div>
                </div>
            </div>

            <!-- ç´°åˆ†åŒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="insights-card" style="margin-bottom: 25px;">
                <div class="insights-title">ğŸ‘œ ä¸»è¦ãƒ¢ãƒ‡ãƒ«åˆ¥åˆ†æï¼ˆ645ä»¶ï¼‰</div>
                <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 15px;">
                    Bearnã€Dogonã€Azapãªã©ã®ãƒ¢ãƒ‡ãƒ«åˆ¥ã«è²©å£²ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã€‚Kelly Walletã‚„Constance Walletã¯é«˜ä¾¡æ ¼å¸¯ã€‚
                </p>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ãƒ¢ãƒ‡ãƒ«åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-wallet-model"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ãƒ¢ãƒ‡ãƒ«åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-wallet-model-price"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ¨ ç´ æåˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-wallet-material"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸŒˆ è‰²åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-wallet-color"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card" style="grid-column: 1 / -1;">
                    <div class="chart-title">ğŸ”¥ ãƒ¢ãƒ‡ãƒ« Ã— ç´ æ ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆä»¶æ•°ï¼‰</div>
                    <div class="chart-container" id="chart-wallet-heatmap" style="height: 500px;"></div>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header">
                    <h3>ä¸»è¦ãƒ¢ãƒ‡ãƒ«è©³ç´°ï¼ˆä»¶æ•°é †ï¼‰</h3>
                    <input type="text" id="search-wallet-model" class="search-input" placeholder="ãƒ¢ãƒ‡ãƒ«åã§æ¤œç´¢...">
                </div>
                <table id="table-wallet-model">
                    <thead>
                        <tr>
                            <th>ãƒ¢ãƒ‡ãƒ«</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æœ€ä½</th>
                            <th>æœ€é«˜</th>
                            <th>ä¸»è¦ç´ æ</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="table-container" style="margin-top: 25px;">
                <div class="table-header">
                    <h3>ãƒ¢ãƒ‡ãƒ« Ã— ç´ æ çµ„ã¿åˆã‚ã›ï¼ˆä»¶æ•°3ä»¥ä¸Šï¼‰</h3>
                </div>
                <table id="table-wallet-cross">
                    <thead>
                        <tr>
                            <th>ãƒ¢ãƒ‡ãƒ«</th>
                            <th>ç´ æ</th>
                            <th>ä»¶æ•°</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="table-container" style="margin-top: 25px;">
                <div class="table-header">
                    <h3>ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—åˆ¥ï¼ˆæ±ç”¨åˆ†é¡ï¼‰</h3>
                </div>
                <table id="table-leather">
                    <thead>
                        <tr>
                            <th>ç¨®é¡</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Parts Tab -->
        <div id="parts" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“¦</div>
                    <div class="stat-value">350</div>
                    <div class="stat-label">ä»˜å±å“è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value">$55,685</div>
                    <div class="stat-label">ç·å£²ä¸Š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$105</div>
                    <div class="stat-label">ä¸­å¤®å€¤</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š ç¨®é¡åˆ¥è²©å£²æ•°</div>
                    <div class="chart-container" id="chart-parts-type"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ ç¨®é¡åˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ï¼‰</div>
                    <div class="chart-container" id="chart-parts-price"></div>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header">
                    <h3>ä»˜å±å“ç¨®é¡åˆ¥è©³ç´°</h3>
                </div>
                <table id="table-parts">
                    <thead>
                        <tr>
                            <th>ç¨®é¡</th>
                            <th>ä»¶æ•°</th>
                            <th>å¹³å‡ä¾¡æ ¼</th>
                            <th>ä¸­å¤®å€¤</th>
                            <th>æ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Other Tab -->
        <div id="other" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Œ</div>
                    <div class="stat-value">756</div>
                    <div class="stat-label">ãã®ä»–è²©å£²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“‚</div>
                    <div class="stat-value">54</div>
                    <div class="stat-label">ç´°åˆ†åŒ–ã‚«ãƒ†ã‚´ãƒªæ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-value">$225</div>
                    <div class="stat-label">ä¸­å¤®å€¤</div>
                </div>
            </div>

            <div class="insights-card">
                <div class="insights-title">ğŸ“ ã€Œãã®ä»–ã€ã‚«ãƒ†ã‚´ãƒª 54ç¨®é¡ã«ç´°åˆ†åŒ–</div>
                <div class="insight-item"><strong>ã‚¨ãƒ«ãƒ¡ã‚¹é›‘è²¨ï¼ˆ323ä»¶ï¼‰:</strong> ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼æ¼ã‚Œ161ä»¶ã€ãƒãƒƒã‚°æ¼ã‚Œ105ä»¶ã€ã‚¹ã‚«ãƒ¼ãƒ•æ¼ã‚Œ22ä»¶ã€ã‚¹ãƒˆãƒ©ãƒƒãƒ—9ä»¶ãªã©</div>
                <div class="insight-item"><strong>ãƒ›ãƒ¼ãƒ ï¼ˆ62ä»¶ï¼‰:</strong> ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«15ä»¶ã€ãƒãƒ³ãƒ‰ã‚¿ã‚ªãƒ«17ä»¶ã€ã‚°ãƒ©ã‚¹9ä»¶ã€ãƒ•ãƒ¬ãƒ¼ãƒ 10ä»¶ãªã©</div>
                <div class="insight-item"><strong>è¡£é¡ï¼ˆ61ä»¶ï¼‰:</strong> ãƒ‹ãƒƒãƒˆ30ä»¶ã€ã‚¸ãƒ£ã‚±ãƒƒãƒˆ10ä»¶ã€ã‚·ãƒ£ãƒ„11ä»¶ã€ã‚¹ãƒ¼ãƒ„4ä»¶ï¼ˆä¸­å¤®å€¤$2,797ï¼‰ãªã©</div>
                <div class="insight-item"><strong>é´ï¼ˆ57ä»¶ï¼‰:</strong> ã‚µãƒ³ãƒ€ãƒ«18ä»¶ï¼ˆ$518ï¼‰ã€ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼15ä»¶ï¼ˆ$325ï¼‰ã€ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼6ä»¶ãªã©</div>
                <div class="insight-item"><strong>ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³å°ç‰©ï¼ˆ30ä»¶ï¼‰:</strong> å¸½å­14ä»¶ã€æ‰‹è¢‹11ä»¶ã€ãƒ™ãƒ“ãƒ¼ç”¨å“4ä»¶</div>
                <div class="insight-item"><strong>æ™‚è¨ˆï¼ˆ30ä»¶ï¼‰:</strong> Clipperã€H08ãªã©ã®è…•æ™‚è¨ˆï¼ˆä¸­å¤®å€¤$501ï¼‰</div>
                <div class="insight-item"><strong>ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒŠãƒªãƒ¼ãƒ»ã‚²ãƒ¼ãƒ ï¼ˆ31ä»¶ï¼‰:</strong> ãƒˆãƒ©ãƒ³ãƒ—28ä»¶ï¼ˆ$118ï¼‰ã€ãƒ•ãƒªã‚¹ãƒ“ãƒ¼2ä»¶</div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ“Š å¤§ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†å¸ƒ</div>
                    <div class="chart-container" id="chart-other-major"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ“ˆ è©³ç´°ã‚«ãƒ†ã‚´ãƒªåˆ¥ï¼ˆä¸Šä½20ï¼‰</div>
                    <div class="chart-container" id="chart-other-detail"></div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-title">ğŸ’µ è©³ç´°ã‚«ãƒ†ã‚´ãƒªåˆ¥ä¾¡æ ¼ï¼ˆä¸­å¤®å€¤ãƒ»ä¸Šä½15ï¼‰</div>
                    <div class="chart-container" id="chart-other-price"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">ğŸ”¥ å¤§ã‚«ãƒ†ã‚´ãƒªÃ—ä¾¡æ ¼å¸¯ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</div>
                    <div class="chart-container" id="chart-other-heatmap"></div>
                </div>
            </div>

            <!-- Other Detail Table -->
            <div class="table-container">
                <div class="table-header">
                    <h3>ã€Œãã®ä»–ã€è©³ç´°ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ï¼ˆ54ç¨®é¡ï¼‰</h3>
                    <input type="text" id="search-other-category" placeholder="ğŸ” ã‚«ãƒ†ã‚´ãƒªæ¤œç´¢..." style="padding: 8px 12px; border-radius: 5px; border: 1px solid var(--border); background: var(--bg-dark); color: var(--text); width: 200px;">
                </div>
                <table id="table-other-detail">
                    <thead>
                        <tr>
                            <th onclick="sortTable('table-other-detail', 0)">ã‚«ãƒ†ã‚´ãƒª â–¼</th>
                            <th onclick="sortTable('table-other-detail', 1)">ä»¶æ•° â–¼</th>
                            <th onclick="sortTable('table-other-detail', 2)">ä¸­å¤®å€¤($) â–¼</th>
                            <th onclick="sortTable('table-other-detail', 3)">å¹³å‡($) â–¼</th>
                            <th onclick="sortTable('table-other-detail', 4)">æœ€é«˜å€¤($) â–¼</th>
                            <th>ãƒ¡ãƒ«ã‚«ãƒªæ¤œç´¢</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Other Cross Table -->
            <div class="table-container">
                <div class="table-header">
                    <h3>å¤§ã‚«ãƒ†ã‚´ãƒªÃ—è©³ç´°ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</h3>
                </div>
                <table id="table-other-cross">
                    <thead>
                        <tr>
                            <th>å¤§ã‚«ãƒ†ã‚´ãƒª</th>
                            <th>ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</th>
                            <th>ä»¶æ•°</th>
                            <th>ä¸­å¤®å€¤($)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>Generated at: 2026-01-23 | Data Source: eBay Terapeak | Total Records: 9,735</p>
            <p>ğŸ¤– Generated with Claude Code</p>
        </div>
    </div>

    <script>
        // ===== DATA =====
        const analysisData = {
            "category_distribution": {
                "ã‚¹ã‚«ãƒ¼ãƒ•": {"count": 5430, "total_sales": 925813.38, "avg_price": 170.50, "median_price": 113.50, "icon": "ğŸ§£"},
                "ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼": {"count": 1149, "total_sales": 289486.56, "avg_price": 251.95, "median_price": 171.00, "icon": "ğŸ’"},
                "ãƒãƒƒã‚°": {"count": 918, "total_sales": 824341.40, "avg_price": 897.98, "median_price": 122.50, "icon": "ğŸ‘œ"},
                "è²¡å¸ƒãƒ»é©å°ç‰©": {"count": 777, "total_sales": 113232.40, "avg_price": 145.73, "median_price": 100.00, "icon": "ğŸ’¼"},
                "ãã®ä»–": {"count": 756, "total_sales": 416620.21, "avg_price": 551.08, "median_price": 224.98, "icon": "ğŸ“Œ"},
                "ä»˜å±å“": {"count": 350, "total_sales": 55685.29, "avg_price": 159.10, "median_price": 105.17, "icon": "ğŸ“¦"},
                "æ™‚è¨ˆ": {"count": 169, "total_sales": 75654.93, "avg_price": 447.66, "median_price": 373.00, "icon": "âŒš"},
                "ãƒ›ãƒ¼ãƒ ãƒ»é£Ÿå™¨": {"count": 149, "total_sales": 38742.95, "avg_price": 260.02, "median_price": 197.25, "icon": "ğŸ½ï¸"},
                "é¦™æ°´": {"count": 37, "total_sales": 4828.96, "avg_price": 130.51, "median_price": 129.20, "icon": "ğŸŒ¸"}
            },
            "scarf_analysis": {
                "by_size": {
                    "ã‚«ãƒ¬90": {"count": 2886, "avg_price": 177.06, "median_price": 128.50},
                    "ä¸æ˜": {"count": 1608, "avg_price": 128.66, "median_price": 85.00},
                    "ãƒ„ã‚¤ãƒªãƒ¼": {"count": 439, "avg_price": 152.67, "median_price": 137.50},
                    "ã‚«ãƒ¬45": {"count": 224, "avg_price": 210.10, "median_price": 178.08},
                    "ãƒ—ãƒªãƒƒã‚»": {"count": 125, "avg_price": 174.48, "median_price": 145.00},
                    "ã‚«ãƒ¬70": {"count": 86, "avg_price": 306.57, "median_price": 315.75},
                    "ã‚¹ãƒˆãƒ¼ãƒ«": {"count": 62, "avg_price": 736.66, "median_price": 700.00}
                },
                "by_pattern": {
                    "ä¸æ˜/ãã®ä»–": {"count": 4680, "avg_price": 173.17, "median_price": 119.00},
                    "Brides de Gala": {"count": 183, "avg_price": 118.60, "median_price": 76.00},
                    "Eperon d'Or": {"count": 76, "avg_price": 130.11, "median_price": 100.00},
                    "Les ClÃ©s": {"count": 75, "avg_price": 101.21, "median_price": 96.00},
                    "Promenade de Longchamps": {"count": 46, "avg_price": 92.25, "median_price": 82.00},
                    "Les Voitures": {"count": 46, "avg_price": 100.42, "median_price": 68.00},
                    "Le Flacon": {"count": 41, "avg_price": 109.34, "median_price": 112.50},
                    "Bolduc": {"count": 32, "avg_price": 210.60, "median_price": 137.50},
                    "Les Rubans du Cheval": {"count": 32, "avg_price": 95.12, "median_price": 99.00},
                    "Faubourg": {"count": 29, "avg_price": 440.14, "median_price": 458.00},
                    "Ex-Libris": {"count": 26, "avg_price": 218.33, "median_price": 106.00},
                    "Les Tambours": {"count": 26, "avg_price": 105.10, "median_price": 101.25},
                    "Les Cavaliers d'Or": {"count": 25, "avg_price": 99.27, "median_price": 92.00},
                    "Jungle Love": {"count": 20, "avg_price": 321.58, "median_price": 238.80},
                    "Chasse en Inde": {"count": 20, "avg_price": 197.78, "median_price": 180.93},
                    "Le Mors": {"count": 17, "avg_price": 94.42, "median_price": 87.00},
                    "Kachinas": {"count": 17, "avg_price": 469.78, "median_price": 468.35},
                    "Les Becanes": {"count": 15, "avg_price": 91.81, "median_price": 67.00},
                    "Les Jardins": {"count": 10, "avg_price": 490.10, "median_price": 445.00}
                }
            },
            "bag_analysis": {
                "by_model": {
                    "ãã®ä»–": {"count": 332, "avg_price": 396.06, "median_price": 176.25, "min_price": 12.50, "max_price": 4044.00},
                    "ãƒ•ãƒ¼ãƒ«ãƒˆã‚¥": {"count": 223, "avg_price": 80.91, "median_price": 76.86, "min_price": 11.50, "max_price": 248.00},
                    "ãƒœãƒªãƒ¼ãƒ‰": {"count": 134, "avg_price": 332.69, "median_price": 70.06, "min_price": 6.50, "max_price": 9240.00},
                    "ã‚±ãƒªãƒ¼": {"count": 76, "avg_price": 2663.19, "median_price": 415.50, "min_price": 74.99, "max_price": 21958.78},
                    "ãƒãƒ¼ã‚­ãƒ³": {"count": 36, "avg_price": 6834.60, "median_price": 7721.93, "min_price": 48.44, "max_price": 16980.00},
                    "ã‚³ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹": {"count": 35, "avg_price": 526.73, "median_price": 168.00, "min_price": 32.00, "max_price": 9653.18},
                    "ã‚¬ãƒ¼ãƒ‡ãƒ³ãƒ‘ãƒ¼ãƒ†ã‚£": {"count": 25, "avg_price": 987.79, "median_price": 821.22, "min_price": 107.50, "max_price": 3200.00},
                    "ã‚¨ãƒ´ãƒªãƒ³": {"count": 17, "avg_price": 1292.13, "median_price": 1425.00, "min_price": 122.50, "max_price": 2810.00},
                    "ãƒ”ã‚³ã‚¿ãƒ³": {"count": 15, "avg_price": 2592.96, "median_price": 2390.00, "min_price": 1198.00, "max_price": 4970.00},
                    "ã‚¨ãƒ«ãƒãƒƒã‚°": {"count": 13, "avg_price": 990.25, "median_price": 738.00, "min_price": 500.00, "max_price": 2940.00},
                    "ãƒªãƒ³ãƒ‡ã‚£": {"count": 8, "avg_price": 6095.46, "median_price": 3615.29, "min_price": 2900.00, "max_price": 12480.00},
                    "ã‚¸ãƒ—ã‚·ã‚¨ãƒ¼ãƒ«": {"count": 3, "avg_price": 3497.09, "median_price": 3485.30, "min_price": 3300.00, "max_price": 3705.97},
                    "ãƒãƒ«ã‚¶ãƒ³": {"count": 1, "avg_price": 5660.00, "median_price": 5660.00, "min_price": 5660.00, "max_price": 5660.00}
                }
            },
            "leather_goods_analysis": {
                "æ‰‹å¸³/ã‚¢ã‚¸ã‚§ãƒ³ãƒ€": {"count": 203, "avg_price": 102.76, "median_price": 80.51},
                "äºŒã¤æŠ˜ã‚Šè²¡å¸ƒ": {"count": 174, "avg_price": 161.71, "median_price": 141.00},
                "ã‚³ã‚¤ãƒ³ã‚±ãƒ¼ã‚¹": {"count": 98, "avg_price": 74.73, "median_price": 66.56},
                "ãƒãƒ¼ãƒ": {"count": 72, "avg_price": 162.31, "median_price": 102.50},
                "ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹": {"count": 69, "avg_price": 150.00, "median_price": 89.00},
                "ã‚­ãƒ¼ã‚±ãƒ¼ã‚¹": {"count": 65, "avg_price": 146.48, "median_price": 100.00},
                "é•·è²¡å¸ƒ": {"count": 60, "avg_price": 225.29, "median_price": 158.09},
                "è²¡å¸ƒï¼ˆãã®ä»–ï¼‰": {"count": 27, "avg_price": 356.06, "median_price": 220.50},
                "ãã®ä»–": {"count": 6, "avg_price": 157.16, "median_price": 139.97},
                "ãƒšãƒ³ã‚±ãƒ¼ã‚¹": {"count": 3, "avg_price": 426.55, "median_price": 128.66}
            },
            "accessory_analysis": {
                "ãƒãƒ³ã‚°ãƒ«/ãƒ–ãƒ¬ã‚¹ãƒ¬ãƒƒãƒˆ": {"count": 324, "avg_price": 239.73, "median_price": 195.25},
                "ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚°": {"count": 314, "avg_price": 147.95, "median_price": 135.99},
                "ã‚«ãƒ‡ãƒŠ/ãƒãƒ£ãƒ¼ãƒ ": {"count": 187, "avg_price": 390.77, "median_price": 242.00},
                "ãƒ™ãƒ«ãƒˆ": {"count": 80, "avg_price": 268.48, "median_price": 179.80},
                "ã‚¤ãƒ¤ãƒªãƒ³ã‚°/ãƒ”ã‚¢ã‚¹": {"count": 78, "avg_price": 438.72, "median_price": 213.25},
                "ãƒã‚¯ã‚¿ã‚¤": {"count": 67, "avg_price": 99.19, "median_price": 67.64},
                "ãƒãƒƒã‚¯ãƒ¬ã‚¹": {"count": 65, "avg_price": 375.92, "median_price": 189.00},
                "ãƒ–ãƒ­ãƒ¼ãƒ": {"count": 24, "avg_price": 197.23, "median_price": 157.00},
                "ã‚°ãƒ­ãƒ¼ãƒ–ãƒ›ãƒ«ãƒ€ãƒ¼": {"count": 10, "avg_price": 77.20, "median_price": 53.00}
            },
            "parts_analysis": {
                "ç©ºç®±": {"count": 142, "avg_price": 230.76, "median_price": 233.38},
                "ãƒ€ã‚¹ãƒˆãƒãƒƒã‚°": {"count": 100, "avg_price": 139.15, "median_price": 98.49},
                "ãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚«ãƒ¼ãƒ‰": {"count": 48, "avg_price": 54.39, "median_price": 39.91},
                "ãƒ¬ã‚¤ãƒ³ã‚«ãƒãƒ¼": {"count": 23, "avg_price": 50.30, "median_price": 46.13},
                "ãƒªãƒœãƒ³": {"count": 22, "avg_price": 196.66, "median_price": 141.75},
                "ã‚¬ãƒ¼ãƒ¡ãƒ³ãƒˆãƒãƒƒã‚°": {"count": 11, "avg_price": 75.85, "median_price": 55.72},
                "ã‚¹ãƒ†ãƒƒã‚«ãƒ¼": {"count": 4, "avg_price": 18.53, "median_price": 20.38}
            },
            "price_distribution": {
                "~$50": 861,
                "$50-100": 2923,
                "$100-200": 3089,
                "$200-500": 2059,
                "$500-1000": 468,
                "$1000-2000": 189,
                "$2000-5000": 89,
                "$5000-10000": 38,
                "$10000+": 19
            },
            "material_distribution": {
                "ã‚·ãƒ«ã‚¯": 5189,
                "ä¸æ˜": 1916,
                "ãƒ¬ã‚¶ãƒ¼": 1158,
                "ã‚­ãƒ£ãƒ³ãƒã‚¹": 550,
                "ã‚´ãƒ¼ãƒ«ãƒ‰": 355,
                "ã‚·ãƒ«ãƒãƒ¼": 210,
                "ã‚¨ãƒŠãƒ¡ãƒ«": 149,
                "ç£å™¨": 80,
                "ãã®ä»–": 128
            },
            "other_detail": {
                "ãã®ä»–ï¼ˆä¸æ˜ï¼‰": {"count": 315, "avg_price": 636.14, "median_price": 238.00, "sample_items": [
                    {"title": "HERMES Constance3 Miroir Size Mini Swift Leather Rose Sakura", "price": 14720.00},
                    {"title": "HERMES HAUT A COURROIES Size 40 Togo Leather/Toile Military Blue Nuit", "price": 11660.00},
                    {"title": "HERMES Rolling Mobility Suitcase Taurillon/Toile Gold/Multicolor", "price": 7410.00},
                    {"title": "HERMES Della Cavalleria Elan Epsom Black", "price": 7070.00},
                    {"title": "HERMES Della Cavalleria Elan Epsom Ardoise", "price": 6810.00}
                ]},
                "ãƒãƒƒã‚°ï¼ˆæœªåˆ†é¡ï¼‰": {"count": 124, "avg_price": 742.02, "median_price": 220.50, "sample_items": [
                    {"title": "HERMES Kelly Ad GM Backpack Box Calf Blue Nuit Gold Hardware", "price": 8296.90},
                    {"title": "HERMES Kelly 28 No Stamp Black Box Calf Women's Handbag", "price": 7377.29},
                    {"title": "HERMES Kelly 28 Box Calf Handbag Black Circle M (1983)", "price": 6700.00},
                    {"title": "HERMES Constance 23 Shoulder Bag Box carf Women", "price": 5400.00},
                    {"title": "Hermes/Flash/Sailor/Sling bag/Backpack/Leather/Black", "price": 3998.00}
                ]},
                "ã‚¹ã‚«ãƒ¼ãƒ•ï¼ˆæœªåˆ†é¡ï¼‰": {"count": 101, "avg_price": 143.01, "median_price": 81.20, "sample_items": [
                    {"title": "Hermes Twilly Silk Scarf Criquetis Finesse Lamb Leather Fringe Beads Embroidery", "price": 1551.36},
                    {"title": "HERMES Carree80 scarf Bord a Bord 25 Spring/Summer New Arrivals blue cotton", "price": 510.00},
                    {"title": "Unused w/box HERMES Carre 90 H EN VOYAGE Cashmere Silk Fringe Scarf 90cm Rare", "price": 480.00},
                    {"title": "Hermes Carre90Brid Et D'Estance Calf Blanc/Marine/Multisilk", "price": 475.55},
                    {"title": "HERMES scarf Carres 90 Quai aux fleurs flowering riverside avenue", "price": 451.97}
                ]},
                "é´": {"count": 55, "avg_price": 425.11, "median_price": 327.25, "sample_items": [
                    {"title": "HERMES Faustin short boots Size 35 Calf Leather Beige", "price": 1360.00},
                    {"title": "HERMES Saint Germain ankle boots Size 39 1/2 Calf Leather Black", "price": 1170.00},
                    {"title": "HERMES Sandalsã€ŠGlamourã€‹ Size 37 Leather Black", "price": 980.00},
                    {"title": "HERMES Ballet shoes \"Jane\" Size 38 Velour/Fabric/Satin Black", "price": 960.00},
                    {"title": "Men 8.5US Hermes Sneakers 42", "price": 943.15}
                ]},
                "è¡£é¡": {"count": 50, "avg_price": 633.71, "median_price": 534.50, "sample_items": [
                    {"title": "2024 SS HERMES Long Cardigan Long Sleeves Fannie Ice Cream#34 Vert Oyat", "price": 2532.00},
                    {"title": "2024AW HERMES Women's Twill Laine Kaleidoscope Effect Cropped pajamas Pants", "price": 1635.00},
                    {"title": "Hermes 1990s Leather Coat Size 44 Heavy Outerwear Very Good Condition", "price": 1490.00},
                    {"title": "HERMES by Margiela period Single-Breasted Coat Beige Size 36/S Vintage", "price": 1402.74},
                    {"title": "HERMES Shirt cardigan Size 38 Cashmere100% Navy", "price": 1210.00}
                ]},
                "ã‚¿ã‚ªãƒ«/ãƒªãƒãƒ³": {"count": 33, "avg_price": 364.45, "median_price": 319.50, "sample_items": [
                    {"title": "HERMES Avalon Jump H Blanket Wool 90%/Cashmere10% Gray/Multicolor", "price": 910.00},
                    {"title": "HERMES Avalon Other miscellaneous goods blanket Black / white wool/cashmere", "price": 884.00},
                    {"title": "HERMES Grand Lala Blanket Wool 90%/Cashmere10% Brown", "price": 860.00},
                    {"title": "HERMES Avalon Blanket Throw H Blanket Merino Wool Cashmere Orange Good Used", "price": 832.50},
                    {"title": "Hermes Avalon Throw Blanket Vintage H Pattern 66.5x49.2 Yellow x Navy", "price": 720.00}
                ]},
                "ãƒˆãƒ©ãƒ³ãƒ—/ã‚²ãƒ¼ãƒ ": {"count": 28, "avg_price": 129.71, "median_price": 117.64, "sample_items": [
                    {"title": "HERMES Authentic Deck of Playing Card Red Blue Years Gift Cards 2018 W/ Box RARE", "price": 261.79},
                    {"title": "HERMES Playing Cards Game Set of 2 Rare Unused", "price": 201.00},
                    {"title": "HERMES Playing Cards Etuicult GM Case Orange", "price": 199.99},
                    {"title": "HERMES 2 Deck of Playing Cards Trump Game Authentic Cheval de Fete Horse Design", "price": 179.98},
                    {"title": "HERMES Tarot Cards With Manual Authentic Deck of Playing Cards SUN Designed RARE", "price": 179.98}
                ]},
                "æ™‚è¨ˆé–¢é€£": {"count": 25, "avg_price": 604.31, "median_price": 499.00, "sample_items": [
                    {"title": "HERMES Clipper Watches CP2.810 grayDial Stainless Steel Mechanical Automatic", "price": 1350.00},
                    {"title": "Hermes Women's Clipper Diver Chronograph Cl2.320 Quartz", "price": 1316.32},
                    {"title": "HERMES Cape Cod CC1.210 Watches", "price": 1316.00},
                    {"title": "HERMES CP2.810 Clipper Date Automatic Stainless steel mens", "price": 1265.00},
                    {"title": "HERMES Clipper Watches CL1.320 Chronograph cal.251.471 whiteDial", "price": 1000.00}
                ]},
                "å¸½å­": {"count": 13, "avg_price": 243.10, "median_price": 181.80, "sample_items": [
                    {"title": "Hermes Casquette Wool Cap Black 57cm 22.4in Luxury Hat Authentic Item", "price": 455.00},
                    {"title": "HERMES FranÃ§oise Hat Brides de Gala Wool Size 57 Black Guarantee", "price": 400.00},
                    {"title": "HERMES Cap Garate Serie Button Size 57 Raffia Navy", "price": 370.00},
                    {"title": "HERMES Hat \"Harper\" Velvet Size 58 Cotton100% Chocolat", "price": 330.00},
                    {"title": "Genuine HERMES straw hat straw hat newsboy cap Serie size 59 used", "price": 300.00}
                ]},
                "ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼ï¼ˆé«˜ç´šï¼‰": {"count": 10, "avg_price": 1788.21, "median_price": 1356.00, "sample_items": [
                    {"title": "HERMES Chaine d'Ancre Punk Ring Size 52/#12 18K Pink Gold", "price": 5560.00},
                    {"title": "HERMES Ring ã€ŠFinesseã€‹ Size 53/#13 18K White Gold", "price": 2820.00},
                    {"title": "HERMES Ring ã€ŠFinesseã€‹ Size 53/#13 18K Pink Gold", "price": 2736.00},
                    {"title": "HERMES Chaine d'Ancre Anchene Ring Size PM/52/#12 18K Pink Gold", "price": 1530.00},
                    {"title": "HERMES Ramsis Mini HH1.110 shell/diamond Ladies Watches quartz", "price": 1386.00}
                ]},
                "ã‚ªãƒ–ã‚¸ã‚§/ã‚¤ãƒ³ãƒ†ãƒªã‚¢": {"count": 2, "avg_price": 1453.50, "median_price": 1453.50, "sample_items": [
                    {"title": "HERMES Arion Object Mahogany Akaju Ebeneze", "price": 2710.00},
                    {"title": "HERMES Clickazoo Object White Black CLICKAZOO Pigeon Chevre Swift Unisex", "price": 197.00}
                ]}
            },
            "other_detail_analysis": {
                "total_count": 756,
                "category_count": 54,
                "detail_categories": {
                    "Accessory/ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ï¼ˆãã®ä»–ï¼‰": {"count": 161, "avg_price": 287.31, "median_price": 131.5, "max_price": 5560.0},
                    "Unclassified/æœªåˆ†é¡": {"count": 127, "avg_price": 628.78, "median_price": 238.0, "max_price": 11660.0},
                    "Bag/ãƒãƒƒã‚°ï¼ˆãã®ä»–ï¼‰": {"count": 105, "avg_price": 1325.34, "median_price": 427.0, "max_price": 14720.0},
                    "Knitwear/ãƒ‹ãƒƒãƒˆ": {"count": 30, "avg_price": 681.89, "median_price": 635.22, "max_price": 2532.0},
                    "Watch/æ™‚è¨ˆ": {"count": 30, "avg_price": 748.86, "median_price": 500.6, "max_price": 4192.0},
                    "Playing Cards/ãƒˆãƒ©ãƒ³ãƒ—": {"count": 28, "avg_price": 129.71, "median_price": 117.64, "max_price": 261.79},
                    "Scarf/ã‚¹ã‚«ãƒ¼ãƒ•ï¼ˆãã®ä»–ï¼‰": {"count": 22, "avg_price": 305.87, "median_price": 237.94, "max_price": 1090.0},
                    "Sandals/ã‚µãƒ³ãƒ€ãƒ«": {"count": 18, "avg_price": 506.51, "median_price": 517.5, "max_price": 980.0},
                    "Hand Towel/ãƒãƒ³ãƒ‰ã‚¿ã‚ªãƒ«": {"count": 17, "avg_price": 81.03, "median_price": 65.17, "max_price": 180.0},
                    "Beach Towel/ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«": {"count": 15, "avg_price": 403.43, "median_price": 398.0, "max_price": 703.08},
                    "Sneakers/ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼": {"count": 15, "avg_price": 375.48, "median_price": 325.0, "max_price": 943.15},
                    "Hat/å¸½å­": {"count": 14, "avg_price": 247.6, "median_price": 225.9, "max_price": 455.0},
                    "Shoes-Other/é´ãã®ä»–": {"count": 14, "avg_price": 167.12, "median_price": 100.5, "max_price": 686.0},
                    "Wallet/é©å°ç‰©ï¼ˆãã®ä»–ï¼‰": {"count": 14, "avg_price": 226.27, "median_price": 247.0, "max_price": 360.0},
                    "Shirt/Blouse/ã‚·ãƒ£ãƒ„ãƒ»ãƒ–ãƒ©ã‚¦ã‚¹": {"count": 11, "avg_price": 512.97, "median_price": 450.0, "max_price": 1210.0},
                    "Gloves/æ‰‹è¢‹": {"count": 11, "avg_price": 131.79, "median_price": 108.5, "max_price": 288.0},
                    "Frame/ãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ": {"count": 10, "avg_price": 136.04, "median_price": 107.12, "max_price": 295.0},
                    "Jacket/Coat/ã‚¸ãƒ£ã‚±ãƒƒãƒˆãƒ»ã‚³ãƒ¼ãƒˆ": {"count": 10, "avg_price": 925.65, "median_price": 850.0, "max_price": 1490.0},
                    "Glassware/ã‚°ãƒ©ã‚¹": {"count": 9, "avg_price": 265.92, "median_price": 238.75, "max_price": 530.0},
                    "Strap/ã‚¹ãƒˆãƒ©ãƒƒãƒ—": {"count": 9, "avg_price": 623.17, "median_price": 715.0, "max_price": 980.0},
                    "Non-Hermes/é™¤å¤–å¯¾è±¡": {"count": 8, "avg_price": 189.74, "median_price": 168.04, "max_price": 445.0},
                    "Equestrian/é¦¬å…·": {"count": 6, "avg_price": 384.58, "median_price": 336.92, "max_price": 690.0},
                    "Loafers/ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼": {"count": 6, "avg_price": 253.05, "median_price": 227.31, "max_price": 460.0},
                    "Comb/ã‚³ãƒ¼ãƒ ": {"count": 6, "avg_price": 147.41, "median_price": 124.24, "max_price": 290.0},
                    "Bag Accessories/ãƒãƒƒã‚°ç”¨å“": {"count": 5, "avg_price": 78.2, "median_price": 65.0, "max_price": 135.0},
                    "Baby/ãƒ™ãƒ“ãƒ¼ç”¨å“": {"count": 4, "avg_price": 316.0, "median_price": 294.0, "max_price": 508.0},
                    "Suit/ã‚¹ãƒ¼ãƒ„": {"count": 4, "avg_price": 2423.19, "median_price": 2797.5, "max_price": 3595.0},
                    "Pants/Skirt/ãƒ‘ãƒ³ãƒ„ãƒ»ã‚¹ã‚«ãƒ¼ãƒˆ": {"count": 4, "avg_price": 315.17, "median_price": 254.68, "max_price": 575.0},
                    "Mobile Battery/ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼": {"count": 3, "avg_price": 628.92, "median_price": 745.88, "max_price": 870.0},
                    "Beauty Tools/ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ„ãƒ¼ãƒ«": {"count": 3, "avg_price": 134.67, "median_price": 126.5, "max_price": 165.0},
                    "Petit h/ãƒ—ãƒ†ã‚£ã‚¢ãƒƒã‚·ãƒ¥": {"count": 3, "avg_price": 348.33, "median_price": 270.0, "max_price": 625.0},
                    "Object/ã‚ªãƒ–ã‚¸ã‚§": {"count": 3, "avg_price": 322.86, "median_price": 248.57, "max_price": 510.0},
                    "Wine Tools/ãƒ¯ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«": {"count": 3, "avg_price": 553.33, "median_price": 580.0, "max_price": 680.0},
                    "Tech Accessories/ãƒ†ãƒƒã‚¯ã‚¢ã‚¯ã‚»": {"count": 3, "avg_price": 95.32, "median_price": 99.96, "max_price": 126.0},
                    "Invalid/ç„¡åŠ¹ãƒ‡ãƒ¼ã‚¿": {"count": 2, "avg_price": 246.24, "median_price": 246.24, "max_price": 356.0}
                },
                "major_categories": {
                    "Misc Hermes/ã‚¨ãƒ«ãƒ¡ã‚¹é›‘è²¨": {"count": 323, "subcategories": ["ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼æ¼ã‚Œ", "ãƒãƒƒã‚°æ¼ã‚Œ", "ã‚¹ã‚«ãƒ¼ãƒ•æ¼ã‚Œ", "ã‚¹ãƒˆãƒ©ãƒƒãƒ—", "é¦¬å…·", "Petit h", "ãƒ¯ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«"]},
                    "Unclassified/æœªåˆ†é¡": {"count": 127, "subcategories": ["æœªåˆ†é¡"]},
                    "Home/ãƒ›ãƒ¼ãƒ ": {"count": 62, "subcategories": ["ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«", "ãƒãƒ³ãƒ‰ã‚¿ã‚ªãƒ«", "ã‚°ãƒ©ã‚¹", "ãƒ•ãƒ¬ãƒ¼ãƒ ", "ã‚ªãƒ–ã‚¸ã‚§", "ã‚¯ãƒƒã‚·ãƒ§ãƒ³"]},
                    "Clothing/è¡£é¡": {"count": 61, "subcategories": ["ãƒ‹ãƒƒãƒˆ", "ã‚·ãƒ£ãƒ„", "ã‚¸ãƒ£ã‚±ãƒƒãƒˆ", "ã‚¹ãƒ¼ãƒ„", "ãƒ‘ãƒ³ãƒ„ãƒ»ã‚¹ã‚«ãƒ¼ãƒˆ"]},
                    "Shoes/é´": {"count": 57, "subcategories": ["ã‚µãƒ³ãƒ€ãƒ«", "ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼", "ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼", "ãƒ–ãƒ¼ãƒ„", "ãƒ’ãƒ¼ãƒ«"]},
                    "Stationery & Games/ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒŠãƒªãƒ¼": {"count": 31, "subcategories": ["ãƒˆãƒ©ãƒ³ãƒ—", "ãƒ•ãƒªã‚¹ãƒ“ãƒ¼"]},
                    "Watch/æ™‚è¨ˆ": {"count": 30, "subcategories": ["è…•æ™‚è¨ˆ", "æ™‚è¨ˆãƒãƒ³ãƒ‰"]},
                    "Fashion Accessories/ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³å°ç‰©": {"count": 30, "subcategories": ["å¸½å­", "æ‰‹è¢‹", "ãƒ™ãƒ“ãƒ¼"]},
                    "Beauty/ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼": {"count": 11, "subcategories": ["ã‚³ãƒ¼ãƒ ", "ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ„ãƒ¼ãƒ«"]},
                    "Packaging/ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°": {"count": 8, "subcategories": ["ãƒãƒƒã‚°ç”¨å“", "ä¿å­˜è¢‹"]},
                    "Tech/ãƒ†ãƒƒã‚¯": {"count": 6, "subcategories": ["ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼", "ãƒ†ãƒƒã‚¯ã‚¢ã‚¯ã‚»"]}
                }
            },
            "bangle_by_material": {
                "ã‚¨ãƒŠãƒ¡ãƒ«": {"count": 117, "avg_price": 221.07, "median_price": 212.49},
                "ãƒ¬ã‚¶ãƒ¼": {"count": 105, "avg_price": 166.00, "median_price": 162.40},
                "ä¸æ˜": {"count": 55, "avg_price": 286.09, "median_price": 250.00},
                "ã‚´ãƒ¼ãƒ«ãƒ‰": {"count": 24, "avg_price": 405.95, "median_price": 289.50},
                "ã‚·ãƒ«ãƒãƒ¼": {"count": 20, "avg_price": 417.06, "median_price": 214.75},
                "ã‚´ãƒ¼ãƒ«ãƒ‰ãƒ—ãƒ¬ãƒ¼ãƒˆ": {"count": 6, "avg_price": 233.84, "median_price": 210.00}
            },
            "scarf_ring_by_model": {
                "ä¸æ˜/ãã®ä»–": {"count": 107, "avg_price": 160.66, "median_price": 142.99},
                "Chain/Chaine": {"count": 81, "avg_price": 150.57, "median_price": 137.50},
                "Jumbo": {"count": 37, "avg_price": 131.13, "median_price": 123.01},
                "Kelly": {"count": 36, "avg_price": 128.40, "median_price": 130.00},
                "Belt": {"count": 31, "avg_price": 133.74, "median_price": 127.90},
                "Cosmos": {"count": 19, "avg_price": 155.99, "median_price": 168.00},
                "Bolduc": {"count": 3, "avg_price": 161.16, "median_price": 177.00}
            },
            "tie_by_pattern": {
                "ä¸æ˜/ãã®ä»–": {"count": 25, "avg_price": 128.97, "median_price": 77.28},
                "Animal/å‹•ç‰©": {"count": 11, "avg_price": 91.82, "median_price": 54.65},
                "H Logo": {"count": 8, "avg_price": 131.13, "median_price": 115.39},
                "Horse/é¦¬": {"count": 6, "avg_price": 65.63, "median_price": 63.00},
                "Geometric/å¹¾ä½•å­¦": {"count": 5, "avg_price": 49.00, "median_price": 48.00},
                "Chain/é–": {"count": 2, "avg_price": 60.24, "median_price": 60.24},
                "Rope/Belt": {"count": 1, "avg_price": 49.98, "median_price": 49.98},
                "Floral/èŠ±": {"count": 1, "avg_price": 50.00, "median_price": 50.00}
            },
            "animal_pattern_analysis": {
                "Horse/é¦¬": {"count": 244, "avg_price": 192.03, "median_price": 137.00},
                "Chasse en Inde": {"count": 42, "avg_price": 151.46, "median_price": 141.24},
                "Cat/çŒ«": {"count": 25, "avg_price": 196.23, "median_price": 99.99},
                "Jungle Love": {"count": 20, "avg_price": 321.58, "median_price": 238.80},
                "Bird/é³¥": {"count": 18, "avg_price": 237.01, "median_price": 199.50},
                "Dog/çŠ¬": {"count": 17, "avg_price": 427.49, "median_price": 250.00},
                "Les Leopards": {"count": 17, "avg_price": 447.05, "median_price": 390.00},
                "Tiger/è™": {"count": 13, "avg_price": 378.37, "median_price": 307.00},
                "Zebra/ZÃ¨bre": {"count": 12, "avg_price": 255.36, "median_price": 179.50},
                "Elephant/è±¡": {"count": 11, "avg_price": 381.13, "median_price": 463.60},
                "Fish/é­š": {"count": 9, "avg_price": 274.32, "median_price": 288.00},
                "Wildlife": {"count": 8, "avg_price": 304.88, "median_price": 278.25},
                "Butterfly/è¶": {"count": 6, "avg_price": 273.96, "median_price": 234.30},
                "Faune et Flore": {"count": 6, "avg_price": 421.67, "median_price": 374.75},
                "Lion": {"count": 3, "avg_price": 179.87, "median_price": 188.10}
            },
            "size_animal_cross": [
                {"size": "ã‚«ãƒ¬90", "pattern": "Horse/é¦¬", "count": 135, "median_price": 128.50},
                {"size": "ä¸æ˜", "pattern": "Horse/é¦¬", "count": 66, "median_price": 121.25},
                {"size": "ã‚«ãƒ¬90", "pattern": "Chasse en Inde", "count": 26, "median_price": 166.69},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Horse/é¦¬", "count": 18, "median_price": 121.00},
                {"size": "ã‚«ãƒ¬45", "pattern": "Horse/é¦¬", "count": 16, "median_price": 228.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Cat/çŒ«", "count": 14, "median_price": 110.35},
                {"size": "ä¸æ˜", "pattern": "Chasse en Inde", "count": 14, "median_price": 96.78},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Jungle Love", "count": 12, "median_price": 165.95},
                {"size": "ã‚«ãƒ¬90", "pattern": "Elephant/è±¡", "count": 10, "median_price": 464.30},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Dog/çŠ¬", "count": 10, "median_price": 196.15},
                {"size": "ä¸æ˜", "pattern": "Cat/çŒ«", "count": 10, "median_price": 71.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Bird/é³¥", "count": 10, "median_price": 201.25},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Les Leopards", "count": 8, "median_price": 155.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Tiger/è™", "count": 7, "median_price": 294.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Wildlife", "count": 7, "median_price": 344.00},
                {"size": "ä¸æ˜", "pattern": "Bird/é³¥", "count": 7, "median_price": 198.99},
                {"size": "ã‚«ãƒ¬90", "pattern": "Fish/é­š", "count": 6, "median_price": 305.62},
                {"size": "ä¸æ˜", "pattern": "Zebra/ZÃ¨bre", "count": 6, "median_price": 199.75},
                {"size": "ã‚«ãƒ¬90", "pattern": "Dog/çŠ¬", "count": 5, "median_price": 498.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Faune et Flore", "count": 5, "median_price": 412.00},
                {"size": "ã‚«ãƒ¬70", "pattern": "Horse/é¦¬", "count": 5, "median_price": 244.50},
                {"size": "ã‚¹ãƒˆãƒ¼ãƒ«", "pattern": "Horse/é¦¬", "count": 4, "median_price": 939.65},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Zebra/ZÃ¨bre", "count": 4, "median_price": 143.07},
                {"size": "ã‚¹ãƒˆãƒ¼ãƒ«", "pattern": "Les Leopards", "count": 3, "median_price": 1244.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Jungle Love", "count": 3, "median_price": 410.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les Leopards", "count": 3, "median_price": 670.00},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Butterfly/è¶", "count": 3, "median_price": 165.12},
                {"size": "ä¸æ˜", "pattern": "Tiger/è™", "count": 3, "median_price": 298.00}
            ],
            "size_pattern_cross": [
                {"size": "ã‚«ãƒ¬90", "pattern": "Brides de Gala", "count": 119, "median_price": 76.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les ClÃ©s", "count": 56, "median_price": 94.20},
                {"size": "ã‚«ãƒ¬90", "pattern": "Eperon d'Or", "count": 54, "median_price": 89.28},
                {"size": "ä¸æ˜", "pattern": "Brides de Gala", "count": 40, "median_price": 64.50},
                {"size": "ã‚«ãƒ¬90", "pattern": "Promenade de Longchamps", "count": 36, "median_price": 90.50},
                {"size": "ã‚«ãƒ¬90", "pattern": "Le Flacon", "count": 31, "median_price": 121.50},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les Voitures", "count": 29, "median_price": 72.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les Tambours", "count": 23, "median_price": 103.50},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les Rubans du Cheval", "count": 22, "median_price": 99.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Les Cavaliers d'Or", "count": 20, "median_price": 93.00},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Brides de Gala", "count": 14, "median_price": 137.25},
                {"size": "ã‚«ãƒ¬90", "pattern": "Faubourg", "count": 14, "median_price": 495.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Chasse en Inde", "count": 13, "median_price": 198.00},
                {"size": "ã‚«ãƒ¬90", "pattern": "Kachinas", "count": 13, "median_price": 471.60},
                {"size": "ã‚«ãƒ¬90", "pattern": "Ex-Libris", "count": 13, "median_price": 100.00},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Bolduc", "count": 13, "median_price": 110.00},
                {"size": "ä¸æ˜", "pattern": "Les Voitures", "count": 12, "median_price": 49.50},
                {"size": "ãƒ„ã‚¤ãƒªãƒ¼", "pattern": "Eperon d'Or", "count": 10, "median_price": 125.00},
                {"size": "ä¸æ˜", "pattern": "Les ClÃ©s", "count": 10, "median_price": 59.00},
                {"size": "ä¸æ˜", "pattern": "Promenade de Longchamps", "count": 10, "median_price": 64.95},
                {"size": "ã‚«ãƒ¬45", "pattern": "Brides de Gala", "count": 9, "median_price": 210.00}
            ],
            "accessory_detail": {
                "total_count": 1498,
                "item_type_analysis": {
                    "Brooch/Pin": {"count": 188, "avg_price": 264.67, "median_price": 160.0, "min_price": 26.0, "max_price": 5560.0},
                    "Tie - Silk": {"count": 118, "avg_price": 95.89, "median_price": 60.88, "min_price": 1.0, "max_price": 599.0},
                    "Bangle - Enamel": {"count": 96, "avg_price": 221.84, "median_price": 202.5, "min_price": 86.0, "max_price": 650.0},
                    "Cadena/Padlock": {"count": 87, "avg_price": 222.79, "median_price": 152.5, "min_price": 15.25, "max_price": 1370.99},
                    "Scarf Ring (Other)": {"count": 85, "avg_price": 151.14, "median_price": 135.49, "min_price": 51.0, "max_price": 530.0},
                    "Scarf Ring - Chaine d'Ancre": {"count": 80, "avg_price": 145.41, "median_price": 132.0, "min_price": 67.83, "max_price": 260.0},
                    "Scarf Ring - Gold": {"count": 77, "avg_price": 132.8, "median_price": 122.49, "min_price": 43.0, "max_price": 473.0},
                    "Leather Bracelet": {"count": 75, "avg_price": 165.18, "median_price": 149.5, "min_price": 61.0, "max_price": 530.0},
                    "Earrings": {"count": 74, "avg_price": 451.3, "median_price": 214.25, "min_price": 84.0, "max_price": 3690.0},
                    "Necklace": {"count": 74, "avg_price": 344.87, "median_price": 181.74, "min_price": 82.0, "max_price": 4300.0},
                    "Ring": {"count": 72, "avg_price": 225.77, "median_price": 149.72, "min_price": 8.5, "max_price": 2820.0},
                    "Tie": {"count": 70, "avg_price": 110.34, "median_price": 70.0, "min_price": 10.0, "max_price": 455.0},
                    "Chain Necklace": {"count": 63, "avg_price": 276.81, "median_price": 163.78, "min_price": 53.87, "max_price": 2340.0},
                    "Belt": {"count": 57, "avg_price": 254.41, "median_price": 156.61, "min_price": 20.0, "max_price": 1110.0},
                    "Bangle": {"count": 55, "avg_price": 257.82, "median_price": 250.0, "min_price": 53.52, "max_price": 586.0},
                    "Belt - Constance": {"count": 43, "avg_price": 180.05, "median_price": 171.5, "min_price": 32.0, "max_price": 416.0},
                    "Charm": {"count": 31, "avg_price": 235.12, "median_price": 175.0, "min_price": 40.0, "max_price": 1072.0},
                    "Bracelet": {"count": 27, "avg_price": 523.77, "median_price": 224.5, "min_price": 49.1, "max_price": 4700.0},
                    "Scarf Ring - Cosmos": {"count": 17, "avg_price": 153.73, "median_price": 167.5, "min_price": 69.0, "max_price": 198.0},
                    "Scarf Ring - Silver/Palladium": {"count": 17, "avg_price": 148.33, "median_price": 120.0, "min_price": 54.74, "max_price": 265.08},
                    "Cufflinks": {"count": 10, "avg_price": 195.42, "median_price": 189.5, "min_price": 55.0, "max_price": 410.0},
                    "Charm - Rodeo": {"count": 10, "avg_price": 649.25, "median_price": 607.5, "min_price": 270.0, "max_price": 1440.0},
                    "Glove Holder/Filou": {"count": 9, "avg_price": 90.28, "median_price": 51.0, "min_price": 26.0, "max_price": 211.0},
                    "Belt - Reversible": {"count": 8, "avg_price": 256.64, "median_price": 164.5, "min_price": 16.0, "max_price": 742.0},
                    "Belt Buckle Only": {"count": 7, "avg_price": 319.17, "median_price": 244.9, "min_price": 58.8, "max_price": 856.0},
                    "Collier de Chien": {"count": 7, "avg_price": 422.84, "median_price": 317.05, "min_price": 130.5, "max_price": 1382.0},
                    "Clic Clac": {"count": 5, "avg_price": 210.0, "median_price": 246.5, "min_price": 81.0, "max_price": 365.0},
                    "Cadena - Elephant": {"count": 5, "avg_price": 313.05, "median_price": 306.0, "min_price": 226.49, "max_price": 411.74},
                    "Belt - H Buckle": {"count": 5, "avg_price": 440.53, "median_price": 397.0, "min_price": 195.0, "max_price": 724.0},
                    "Hapi": {"count": 4, "avg_price": 144.88, "median_price": 157.5, "min_price": 101.0, "max_price": 163.5},
                    "Kelly Double Tour": {"count": 4, "avg_price": 301.38, "median_price": 192.75, "min_price": 120.0, "max_price": 700.0},
                    "Chain Bracelet": {"count": 4, "avg_price": 1471.32, "median_price": 1570.0, "min_price": 425.28, "max_price": 2320.0}
                },
                "material_analysis": {
                    "Unknown": {"count": 433, "avg_price": 207.36, "median_price": 147.38},
                    "Leather": {"count": 249, "avg_price": 191.59, "median_price": 150.0},
                    "Silk": {"count": 211, "avg_price": 138.69, "median_price": 116.11},
                    "Gold/GP": {"count": 207, "avg_price": 280.14, "median_price": 162.45},
                    "Silver": {"count": 183, "avg_price": 288.76, "median_price": 162.0},
                    "Enamel": {"count": 138, "avg_price": 223.7, "median_price": 208.5},
                    "Gold Plated": {"count": 42, "avg_price": 158.48, "median_price": 118.98},
                    "18K Gold": {"count": 14, "avg_price": 1981.57, "median_price": 1515.0},
                    "Horn/Buffalo": {"count": 8, "avg_price": 308.62, "median_price": 294.5},
                    "Metal": {"count": 8, "avg_price": 315.18, "median_price": 289.5},
                    "Palladium": {"count": 5, "avg_price": 241.05, "median_price": 255.0}
                },
                "type_material_cross": [
                    {"type": "Tie - Silk", "material": "Silk", "count": 114, "median": 61.42},
                    {"type": "Bangle - Enamel", "material": "Enamel", "count": 96, "median": 202.5},
                    {"type": "Brooch/Pin", "material": "Silk", "count": 70, "median": 161.75},
                    {"type": "Tie", "material": "Unknown", "count": 69, "median": 70.0},
                    {"type": "Brooch/Pin", "material": "Unknown", "count": 65, "median": 144.4},
                    {"type": "Scarf Ring (Other)", "material": "Unknown", "count": 63, "median": 135.49},
                    {"type": "Leather Bracelet", "material": "Leather", "count": 60, "median": 153.75},
                    {"type": "Scarf Ring - Gold", "material": "Gold/GP", "count": 53, "median": 126.5},
                    {"type": "Scarf Ring - Chaine d'Ancre", "material": "Unknown", "count": 52, "median": 140.0},
                    {"type": "Chain Necklace", "material": "Unknown", "count": 49, "median": 138.78},
                    {"type": "Cadena/Padlock", "material": "Silver", "count": 48, "median": 126.5},
                    {"type": "Belt - Constance", "material": "Leather", "count": 35, "median": 172.5},
                    {"type": "Ring", "material": "Leather", "count": 35, "median": 63.0},
                    {"type": "Necklace", "material": "Silver", "count": 30, "median": 159.5},
                    {"type": "Belt", "material": "Leather", "count": 29, "median": 150.68},
                    {"type": "Brooch/Pin", "material": "Leather", "count": 24, "median": 103.25},
                    {"type": "Cadena/Padlock", "material": "Gold/GP", "count": 21, "median": 234.65},
                    {"type": "Earrings", "material": "Enamel", "count": 21, "median": 204.5},
                    {"type": "Bangle", "material": "Unknown", "count": 20, "median": 300.13},
                    {"type": "Scarf Ring - Gold", "material": "Gold Plated", "count": 20, "median": 89.66}
                ]
            },
            "wallet_analysis": {
                "total_count": 645,
                "total_revenue": 113010.56,
                "avg_price": 175.21,
                "median_price": 107.5,
                "item_type_analysis": {
                    "Bearn": {"count": 128, "avg_price": 185.76, "median_price": 159.0, "min_price": 10.5, "max_price": 805.0},
                    "Azap Silk'in": {"count": 59, "avg_price": 154.33, "median_price": 140.0, "min_price": 41.0, "max_price": 590.0},
                    "Purse": {"count": 59, "avg_price": 112.63, "median_price": 80.0, "min_price": 29.0, "max_price": 931.0},
                    "Coin Purse/Case": {"count": 49, "avg_price": 88.36, "median_price": 61.0, "min_price": 12.5, "max_price": 1076.0},
                    "Card Holder/Case": {"count": 47, "avg_price": 158.99, "median_price": 89.0, "min_price": 17.5, "max_price": 699.99},
                    "Bastia": {"count": 47, "avg_price": 86.1, "median_price": 70.0, "min_price": 2.25, "max_price": 340.0},
                    "Dogon": {"count": 45, "avg_price": 175.91, "median_price": 128.13, "min_price": 20.5, "max_price": 723.0},
                    "Wallet (Other)": {"count": 67, "avg_price": 104.8, "median_price": 59.0, "min_price": 11.61, "max_price": 809.0},
                    "Key Holder/Case": {"count": 27, "avg_price": 71.58, "median_price": 51.0, "min_price": 8.5, "max_price": 319.26},
                    "Long Wallet": {"count": 20, "avg_price": 168.1, "median_price": 150.75, "min_price": 40.0, "max_price": 421.0},
                    "Azap Compact": {"count": 18, "avg_price": 236.67, "median_price": 172.5, "min_price": 29.0, "max_price": 1160.0},
                    "Calvi": {"count": 17, "avg_price": 89.63, "median_price": 73.0, "min_price": 15.5, "max_price": 226.0},
                    "Citizen Twill": {"count": 10, "avg_price": 186.5, "median_price": 102.53, "min_price": 56.0, "max_price": 550.0},
                    "Azap": {"count": 10, "avg_price": 93.45, "median_price": 92.5, "min_price": 18.5, "max_price": 157.5},
                    "Kelly Wallet/Pochette": {"count": 8, "avg_price": 2256.1, "median_price": 1522.78, "min_price": 1058.48, "max_price": 5580.0},
                    "Bearn Soufflet": {"count": 7, "avg_price": 195.31, "median_price": 202.5, "min_price": 86.0, "max_price": 290.0},
                    "MC2": {"count": 6, "avg_price": 286.29, "median_price": 188.5, "min_price": 32.63, "max_price": 800.0},
                    "Dogon Compact/Duo": {"count": 4, "avg_price": 129.75, "median_price": 127.75, "min_price": 61.0, "max_price": 202.5},
                    "Tarmac": {"count": 4, "avg_price": 168.5, "median_price": 142.0, "min_price": 100.0, "max_price": 290.0},
                    "Calvi Duo": {"count": 3, "avg_price": 618.0, "median_price": 680.0, "min_price": 94.0, "max_price": 1080.0},
                    "Passport Holder": {"count": 3, "avg_price": 164.64, "median_price": 148.43, "min_price": 120.5, "max_price": 225.0},
                    "Constance Wallet": {"count": 2, "avg_price": 1640.0, "median_price": 1640.0, "min_price": 1140.0, "max_price": 2140.0}
                },
                "material_analysis": {
                    "Epsom": {"count": 155, "avg_price": 204.57, "median_price": 125.05},
                    "Leather": {"count": 113, "avg_price": 207.87, "median_price": 123.0},
                    "Canvas/Toile": {"count": 92, "avg_price": 64.75, "median_price": 62.5},
                    "Chevre/Mysore": {"count": 86, "avg_price": 148.66, "median_price": 123.5},
                    "Unknown": {"count": 48, "avg_price": 284.86, "median_price": 163.5},
                    "Swift": {"count": 44, "avg_price": 118.43, "median_price": 100.5},
                    "Box Calf": {"count": 44, "avg_price": 213.69, "median_price": 143.0},
                    "Togo": {"count": 25, "avg_price": 134.55, "median_price": 111.36},
                    "Clemence": {"count": 18, "avg_price": 171.99, "median_price": 120.06},
                    "Silk": {"count": 11, "avg_price": 143.77, "median_price": 134.39},
                    "Veau": {"count": 6, "avg_price": 123.67, "median_price": 68.5},
                    "Evercolor": {"count": 3, "avg_price": 667.0, "median_price": 800.0}
                },
                "color_analysis": {
                    "Unknown": {"count": 134, "avg_price": 160.56, "median_price": 90.0},
                    "Black": {"count": 112, "avg_price": 183.69, "median_price": 121.75},
                    "Gold": {"count": 104, "avg_price": 276.48, "median_price": 128.75},
                    "Brown": {"count": 79, "avg_price": 140.18, "median_price": 112.5},
                    "Blue": {"count": 68, "avg_price": 139.99, "median_price": 93.5},
                    "Pink": {"count": 59, "avg_price": 146.14, "median_price": 123.0},
                    "Red": {"count": 38, "avg_price": 118.27, "median_price": 100.75},
                    "Green": {"count": 22, "avg_price": 140.59, "median_price": 113.5},
                    "White": {"count": 12, "avg_price": 207.97, "median_price": 116.8},
                    "Beige": {"count": 8, "avg_price": 76.33, "median_price": 67.0},
                    "Navy": {"count": 7, "avg_price": 235.22, "median_price": 95.0}
                },
                "model_detail": {
                    "Bearn": {"count": 128, "avg_price": 185.76, "median_price": 159.0, "min_price": 10.5, "max_price": 805.0, "materials": {"Epsom": 40, "Leather": 28, "Box Calf": 21, "Chevre/Mysore": 17, "Swift": 17}},
                    "Azap Silk'in": {"count": 59, "avg_price": 154.33, "median_price": 140.0, "min_price": 41.0, "max_price": 590.0, "materials": {"Epsom": 29, "Chevre/Mysore": 22, "Silk": 8}},
                    "Bastia": {"count": 47, "avg_price": 86.1, "median_price": 70.0, "min_price": 2.25, "max_price": 340.0, "materials": {"Epsom": 27, "Chevre/Mysore": 9, "Swift": 5}},
                    "Dogon": {"count": 45, "avg_price": 175.91, "median_price": 128.13, "min_price": 20.5, "max_price": 723.0, "materials": {"Togo": 22, "Clemence": 12, "Leather": 6}},
                    "Calvi": {"count": 17, "avg_price": 89.63, "median_price": 73.0, "min_price": 15.5, "max_price": 226.0, "materials": {"Leather": 8, "Epsom": 6, "Swift": 2}},
                    "Citizen Twill": {"count": 10, "avg_price": 186.5, "median_price": 102.53, "min_price": 56.0, "max_price": 550.0, "materials": {"Box Calf": 3, "Swift": 2, "Chevre/Mysore": 2}},
                    "Kelly Wallet/Pochette": {"count": 8, "avg_price": 2256.1, "median_price": 1522.78, "min_price": 1058.48, "max_price": 5580.0, "materials": {"Leather": 3, "Epsom": 3, "Chevre/Mysore": 1}}
                },
                "model_material_cross": [
                    {"model": "Bearn", "material": "Epsom", "count": 40, "median": 167.5},
                    {"model": "Wallet (Other)", "material": "Canvas/Toile", "count": 37, "median": 51.0},
                    {"model": "Azap Silk'in", "material": "Epsom", "count": 29, "median": 140.0},
                    {"model": "Bearn", "material": "Leather", "count": 28, "median": 152.09},
                    {"model": "Bastia", "material": "Epsom", "count": 27, "median": 70.0},
                    {"model": "Azap Silk'in", "material": "Chevre/Mysore", "count": 22, "median": 145.5},
                    {"model": "Dogon", "material": "Togo", "count": 22, "median": 115.18},
                    {"model": "Bearn", "material": "Box Calf", "count": 21, "median": 171.5},
                    {"model": "Bearn", "material": "Swift", "count": 17, "median": 140.0},
                    {"model": "Bearn", "material": "Chevre/Mysore", "count": 17, "median": 181.28},
                    {"model": "Coin Purse/Case", "material": "Leather", "count": 15, "median": 66.0},
                    {"model": "Card Holder/Case", "material": "Leather", "count": 15, "median": 100.99},
                    {"model": "Dogon", "material": "Clemence", "count": 12, "median": 120.06},
                    {"model": "Coin Purse/Case", "material": "Chevre/Mysore", "count": 11, "median": 61.0},
                    {"model": "Azap Compact", "material": "Epsom", "count": 10, "median": 153.75},
                    {"model": "Coin Purse/Case", "material": "Epsom", "count": 10, "median": 66.0},
                    {"model": "Key Holder/Case", "material": "Leather", "count": 10, "median": 56.5},
                    {"model": "Card Holder/Case", "material": "Unknown", "count": 10, "median": 122.0},
                    {"model": "Bastia", "material": "Chevre/Mysore", "count": 9, "median": 64.11},
                    {"model": "Long Wallet", "material": "Canvas/Toile", "count": 9, "median": 69.0}
                ]
            }
        };

        // ===== THEME =====
        function toggleTheme() {
            const body = document.body;
            const btn = document.querySelector('.theme-toggle');
            if (body.getAttribute('data-theme') === 'light') {
                body.removeAttribute('data-theme');
                btn.textContent = 'ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰';
            } else {
                body.setAttribute('data-theme', 'light');
                btn.textContent = 'â˜€ï¸ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰';
            }
            // Redraw charts
            drawAllCharts();
        }

        // ===== TABS =====
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });

        // ===== CHART CONFIG =====
        function getChartLayout(title = '') {
            const isDark = !document.body.hasAttribute('data-theme');
            return {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: isDark ? '#eee' : '#333', size: 12 },
                margin: { t: 30, b: 50, l: 60, r: 30 },
                showlegend: true,
                legend: { orientation: 'h', y: -0.15 }
            };
        }

        const config = { responsive: true, displayModeBar: false };

        // ===== DRAW CHARTS =====
        function drawAllCharts() {
            drawOverviewCharts();
            drawScarfCharts();
            drawBagCharts();
            drawAccessoryCharts();
            drawLeatherCharts();
            drawPartsCharts();
            drawOtherCharts();
            populateTables();
        }

        function drawOverviewCharts() {
            const catData = analysisData.category_distribution;
            const cats = Object.keys(catData).sort((a, b) => catData[b].count - catData[a].count);

            // Category Count Chart
            Plotly.newPlot('chart-category-count', [{
                type: 'bar',
                x: cats.map(c => catData[c].count),
                y: cats.map(c => catData[c].icon + ' ' + c),
                orientation: 'h',
                marker: { color: '#FF6B00' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            // Category Sales Pie
            Plotly.newPlot('chart-category-sales', [{
                type: 'pie',
                labels: cats,
                values: cats.map(c => catData[c].total_sales),
                hole: 0.4,
                marker: { colors: ['#FF6B00', '#FF9800', '#FFC107', '#4CAF50', '#2196F3', '#9C27B0', '#E91E63', '#00BCD4', '#795548'] },
                textinfo: 'label+percent',
                textposition: 'outside'
            }], {...getChartLayout(), showlegend: false}, config);

            // Price Distribution
            const priceDist = analysisData.price_distribution;
            const priceLabels = Object.keys(priceDist);
            Plotly.newPlot('chart-price-dist', [{
                type: 'bar',
                x: priceLabels,
                y: priceLabels.map(l => priceDist[l]),
                marker: { color: '#4CAF50' }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);

            // Material Distribution
            const matDist = analysisData.material_distribution;
            const mats = Object.keys(matDist).filter(m => m !== 'ä¸æ˜').slice(0, 8);
            Plotly.newPlot('chart-material', [{
                type: 'pie',
                labels: mats,
                values: mats.map(m => matDist[m]),
                hole: 0.3,
                marker: { colors: ['#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#00BCD4', '#009688', '#4CAF50'] }
            }], {...getChartLayout(), showlegend: true}, config);
        }

        function drawScarfCharts() {
            const sizeData = analysisData.scarf_analysis.by_size;
            const sizes = Object.keys(sizeData).filter(s => s !== 'ä¸æ˜').sort((a, b) => sizeData[b].count - sizeData[a].count);

            // Size Count
            Plotly.newPlot('chart-scarf-size', [{
                type: 'pie',
                labels: sizes,
                values: sizes.map(s => sizeData[s].count),
                hole: 0.4,
                marker: { colors: ['#FF6B00', '#FF9800', '#FFC107', '#4CAF50', '#2196F3', '#9C27B0'] }
            }], {...getChartLayout()}, config);

            // Pattern Count (Top 15, excluding unknown)
            const patternData = analysisData.scarf_analysis.by_pattern;
            const patterns = Object.keys(patternData)
                .filter(p => p !== 'ä¸æ˜/ãã®ä»–')
                .sort((a, b) => patternData[b].count - patternData[a].count)
                .slice(0, 15);

            Plotly.newPlot('chart-scarf-pattern', [{
                type: 'bar',
                x: patterns.map(p => patternData[p].count),
                y: patterns,
                orientation: 'h',
                marker: { color: '#E91E63' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            // Size Price Comparison
            Plotly.newPlot('chart-scarf-price', [{
                type: 'bar',
                x: sizes,
                y: sizes.map(s => sizeData[s].median_price),
                marker: { color: '#4CAF50' },
                name: 'ä¸­å¤®å€¤'
            }, {
                type: 'bar',
                x: sizes,
                y: sizes.map(s => sizeData[s].avg_price),
                marker: { color: '#2196F3' },
                name: 'å¹³å‡'
            }], {...getChartLayout(), barmode: 'group'}, config);

            // Heatmap - Size x Pattern (using size_pattern_cross data)
            const heatSizes = ['ã‚«ãƒ¬90', 'ãƒ„ã‚¤ãƒªãƒ¼', 'ã‚«ãƒ¬45', 'ã‚«ãƒ¬70', 'ä¸æ˜'];
            const heatPatterns = ['Brides de Gala', 'Les ClÃ©s', 'Eperon d\'Or', 'Le Flacon', 'Les Voitures', 'Les Tambours', 'Promenade de Longchamps', 'Bolduc'];
            const cross = analysisData.size_pattern_cross || [];
            const heatData = heatSizes.map(size =>
                heatPatterns.map(pattern => {
                    const found = cross.find(c => c.size === size && c.pattern === pattern);
                    return found ? found.count : 0;
                })
            );

            Plotly.newPlot('chart-scarf-heatmap', [{
                type: 'heatmap',
                z: heatData,
                x: heatPatterns,
                y: heatSizes,
                colorscale: 'YlOrRd',
                showscale: true,
                hoverongaps: false,
                text: heatData.map(row => row.map(v => v > 0 ? v : '')),
                texttemplate: '%{text}',
                textfont: {size: 12}
            }], {...getChartLayout(), xaxis: {tickangle: -45}, margin: {t: 30, b: 100, l: 80, r: 30}}, config);

            // Animal Pattern Charts
            drawAnimalCharts();
        }

        function drawAnimalCharts() {
            const animalData = analysisData.animal_pattern_analysis;
            const animals = Object.keys(animalData).sort((a, b) => animalData[b].count - animalData[a].count);

            // Animal Pattern Count
            Plotly.newPlot('chart-animal-pattern', [{
                type: 'bar',
                x: animals.map(a => animalData[a].count),
                y: animals,
                orientation: 'h',
                marker: {
                    color: animals.map((a, i) => ['#8B4513', '#FF6B00', '#9C27B0', '#4CAF50', '#00BCD4', '#E91E63', '#FFC107', '#FF5722', '#607D8B', '#795548', '#2196F3', '#009688', '#673AB7', '#3F51B5', '#FFEB3B'][i % 15])
                },
                text: animals.map(a => animalData[a].count),
                textposition: 'outside'
            }], {...getChartLayout(), yaxis: {automargin: true}, showlegend: false}, config);

            // Animal Price (sorted by median)
            const animalsByPrice = [...animals].sort((a, b) => animalData[b].median_price - animalData[a].median_price);
            Plotly.newPlot('chart-animal-price', [{
                type: 'bar',
                x: animalsByPrice,
                y: animalsByPrice.map(a => animalData[a].median_price),
                marker: {
                    color: animalsByPrice.map(a => animalData[a].median_price),
                    colorscale: 'Viridis'
                }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);

            // Animal Heatmap - Size x Animal Pattern
            const animalSizes = ['ã‚«ãƒ¬90', 'ãƒ„ã‚¤ãƒªãƒ¼', 'ã‚¹ãƒˆãƒ¼ãƒ«', 'ã‚«ãƒ¬45', 'ä¸æ˜'];
            const topAnimals = ['Horse/é¦¬', 'Chasse en Inde', 'Cat/çŒ«', 'Jungle Love', 'Dog/çŠ¬', 'Les Leopards', 'Bird/é³¥', 'Tiger/è™', 'Elephant/è±¡'];
            const animalCross = analysisData.size_animal_cross || [];
            const animalHeatData = animalSizes.map(size =>
                topAnimals.map(pattern => {
                    const found = animalCross.find(c => c.size === size && c.pattern === pattern);
                    return found ? found.count : 0;
                })
            );

            Plotly.newPlot('chart-animal-heatmap', [{
                type: 'heatmap',
                z: animalHeatData,
                x: topAnimals,
                y: animalSizes,
                colorscale: [[0, '#fff5f0'], [0.2, '#fee0d2'], [0.4, '#fcbba1'], [0.6, '#fc9272'], [0.8, '#fb6a4a'], [1, '#de2d26']],
                showscale: true,
                hoverongaps: false,
                text: animalHeatData.map(row => row.map(v => v > 0 ? v : '')),
                texttemplate: '%{text}',
                textfont: {size: 14, color: '#333'}
            }], {...getChartLayout(), xaxis: {tickangle: -45}, margin: {t: 30, b: 120, l: 80, r: 30}}, config);
        }

        function drawBagCharts() {
            const modelData = analysisData.bag_analysis.by_model;
            const models = Object.keys(modelData).sort((a, b) => modelData[b].count - modelData[a].count);

            // Model Count
            Plotly.newPlot('chart-bag-model', [{
                type: 'bar',
                x: models.map(m => modelData[m].count),
                y: models,
                orientation: 'h',
                marker: { color: '#9C27B0' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            // Model Price (sorted by median)
            const modelsByPrice = [...models].sort((a, b) => modelData[b].median_price - modelData[a].median_price);
            Plotly.newPlot('chart-bag-price', [{
                type: 'bar',
                x: modelsByPrice,
                y: modelsByPrice.map(m => modelData[m].median_price),
                marker: {
                    color: modelsByPrice.map(m => modelData[m].median_price),
                    colorscale: 'Viridis'
                }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);
        }

        function drawAccessoryCharts() {
            const data = analysisData.accessory_analysis;
            const types = Object.keys(data).sort((a, b) => data[b].count - data[a].count);

            Plotly.newPlot('chart-accessory-type', [{
                type: 'bar',
                x: types.map(t => data[t].count),
                y: types,
                orientation: 'h',
                marker: { color: '#00BCD4' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            const typesByPrice = [...types].sort((a, b) => data[b].median_price - data[a].median_price);
            Plotly.newPlot('chart-accessory-price', [{
                type: 'bar',
                x: typesByPrice,
                y: typesByPrice.map(t => data[t].median_price),
                marker: { color: '#FF9800' }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);

            // Bangle by Material
            const bangleData = analysisData.bangle_by_material;
            const bangleMats = Object.keys(bangleData).filter(m => m !== 'ä¸æ˜').sort((a, b) => bangleData[b].count - bangleData[a].count);
            Plotly.newPlot('chart-bangle-material', [{
                type: 'pie',
                labels: bangleMats,
                values: bangleMats.map(m => bangleData[m].count),
                hole: 0.4,
                marker: { colors: ['#E91E63', '#795548', '#FFD700', '#C0C0C0', '#B8860B', '#9E9E9E'] },
                textinfo: 'label+percent'
            }], {...getChartLayout(), showlegend: false}, config);

            // Scarf Ring by Model
            const ringData = analysisData.scarf_ring_by_model;
            const ringModels = Object.keys(ringData).filter(m => m !== 'ä¸æ˜/ãã®ä»–').sort((a, b) => ringData[b].count - ringData[a].count);
            Plotly.newPlot('chart-scarf-ring-model', [{
                type: 'bar',
                x: ringModels.map(m => ringData[m].count),
                y: ringModels,
                orientation: 'h',
                marker: { color: '#9C27B0' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            // Tie by Pattern
            const tieData = analysisData.tie_by_pattern;
            const tiePatterns = Object.keys(tieData).filter(p => p !== 'ä¸æ˜/ãã®ä»–').sort((a, b) => tieData[b].count - tieData[a].count);
            Plotly.newPlot('chart-tie-pattern', [{
                type: 'pie',
                labels: tiePatterns,
                values: tiePatterns.map(p => tieData[p].count),
                hole: 0.4,
                marker: { colors: ['#3F51B5', '#673AB7', '#009688', '#4CAF50', '#FFC107', '#FF5722'] },
                textinfo: 'label+percent'
            }], {...getChartLayout(), showlegend: false}, config);

            // Tie Price by Pattern
            const tieByPrice = [...tiePatterns].sort((a, b) => tieData[b].median_price - tieData[a].median_price);
            Plotly.newPlot('chart-tie-price', [{
                type: 'bar',
                x: tieByPrice,
                y: tieByPrice.map(p => tieData[p].median_price),
                marker: { color: '#607D8B' }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);

            // ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼è©³ç´°ãƒãƒ£ãƒ¼ãƒˆ
            drawAccessoryDetailCharts();
        }

        function drawAccessoryDetailCharts() {
            const detail = analysisData.accessory_detail;
            if (!detail) return;

            // ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—åˆ¥è²©å£²æ•°ï¼ˆä¸Šä½20ï¼‰
            const itemTypes = Object.entries(detail.item_type_analysis)
                .sort((a, b) => b[1].count - a[1].count)
                .slice(0, 20);

            Plotly.newPlot('chart-accessory-detail-type', [{
                type: 'bar',
                x: itemTypes.map(([k, v]) => v.count),
                y: itemTypes.map(([k]) => k),
                orientation: 'h',
                marker: {
                    color: itemTypes.map((_, i) =>
                        ['#00BCD4', '#00ACC1', '#0097A7', '#00838F', '#006064',
                         '#4DD0E1', '#26C6DA', '#00BFA5', '#009688', '#00796B',
                         '#4DB6AC', '#26A69A', '#80CBC4', '#B2DFDB', '#E0F2F1',
                         '#4FC3F7', '#29B6F6', '#03A9F4', '#039BE5', '#0288D1'][i % 20]
                    )
                },
                text: itemTypes.map(([k, v]) => `$${v.median_price.toFixed(0)}`),
                textposition: 'outside'
            }], {...getChartLayout(), yaxis: {automargin: true}, margin: {l: 180, r: 80}}, config);

            // ç´ æåˆ¥åˆ†å¸ƒ
            const materials = Object.entries(detail.material_analysis)
                .filter(([k]) => k !== 'Unknown')
                .sort((a, b) => b[1].count - a[1].count);

            Plotly.newPlot('chart-accessory-material', [{
                type: 'pie',
                labels: materials.map(([k]) => k),
                values: materials.map(([k, v]) => v.count),
                hole: 0.4,
                marker: {
                    colors: ['#795548', '#FFD700', '#C0C0C0', '#E91E63', '#B8860B',
                             '#9E9E9E', '#CD7F32', '#4169E1', '#228B22', '#DC143C']
                }
            }], {...getChartLayout()}, config);

            // ã‚¿ã‚¤ãƒ—Ã—ç´ æãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
            const crossData = detail.type_material_cross || [];
            const types = [...new Set(crossData.map(d => d.type))];
            const matList = [...new Set(crossData.map(d => d.material))];

            const heatData = types.map(type =>
                matList.map(mat => {
                    const found = crossData.find(c => c.type === type && c.material === mat);
                    return found ? found.count : 0;
                })
            );

            const heatText = types.map(type =>
                matList.map(mat => {
                    const found = crossData.find(c => c.type === type && c.material === mat);
                    return found ? found.count : '';
                })
            );

            Plotly.newPlot('chart-accessory-heatmap', [{
                type: 'heatmap',
                z: heatData,
                x: matList,
                y: types,
                text: heatText,
                texttemplate: '%{text}',
                colorscale: [
                    [0, '#E0F7FA'],
                    [0.25, '#4DD0E1'],
                    [0.5, '#00BCD4'],
                    [0.75, '#0097A7'],
                    [1, '#006064']
                ],
                showscale: true,
                hoverongaps: false
            }], {
                ...getChartLayout(),
                xaxis: {tickangle: -45, automargin: true},
                yaxis: {automargin: true},
                margin: {l: 180, b: 100, r: 100}
            }, config);
        }

        function drawLeatherCharts() {
            const data = analysisData.leather_goods_analysis;
            const types = Object.keys(data).sort((a, b) => data[b].count - data[a].count);

            Plotly.newPlot('chart-leather-type', [{
                type: 'bar',
                x: types.map(t => data[t].count),
                y: types,
                orientation: 'h',
                marker: { color: '#795548' }
            }], {...getChartLayout(), yaxis: {automargin: true}}, config);

            const typesByPrice = [...types].sort((a, b) => data[b].median_price - data[a].median_price);
            Plotly.newPlot('chart-leather-price', [{
                type: 'bar',
                x: typesByPrice,
                y: typesByPrice.map(t => data[t].median_price),
                marker: { color: '#607D8B' }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);

            // è²¡å¸ƒç´°åˆ†åŒ–ãƒãƒ£ãƒ¼ãƒˆ
            drawWalletCharts();
        }

        function drawWalletCharts() {
            const wallet = analysisData.wallet_analysis;
            if (!wallet) return;

            // ãƒ¢ãƒ‡ãƒ«åˆ¥è²©å£²æ•°ï¼ˆä¸Šä½15ï¼‰
            const itemTypes = Object.entries(wallet.item_type_analysis)
                .sort((a, b) => b[1].count - a[1].count)
                .slice(0, 15);

            Plotly.newPlot('chart-wallet-model', [{
                type: 'bar',
                x: itemTypes.map(([k, v]) => v.count),
                y: itemTypes.map(([k]) => k),
                orientation: 'h',
                marker: {
                    color: itemTypes.map((_, i) =>
                        ['#FF6B00', '#E65100', '#FF9800', '#FFC107', '#795548',
                         '#607D8B', '#9E9E9E', '#5D4037', '#8D6E63', '#A1887F',
                         '#BCAAA4', '#D7CCC8', '#4E342E', '#3E2723', '#6D4C41'][i % 15]
                    )
                },
                text: itemTypes.map(([k, v]) => `$${v.median_price.toFixed(0)}`),
                textposition: 'outside'
            }], {...getChartLayout(), yaxis: {automargin: true}, margin: {l: 150, r: 80}}, config);

            // ãƒ¢ãƒ‡ãƒ«åˆ¥ä¾¡æ ¼ï¼ˆä¸Šä½10ã€é«˜ä¾¡æ ¼é †ï¼‰
            const byPrice = Object.entries(wallet.item_type_analysis)
                .filter(([k, v]) => v.count >= 3)
                .sort((a, b) => b[1].median_price - a[1].median_price)
                .slice(0, 10);

            Plotly.newPlot('chart-wallet-model-price', [{
                type: 'bar',
                x: byPrice.map(([k]) => k),
                y: byPrice.map(([k, v]) => v.median_price),
                marker: {
                    color: byPrice.map((_, i) => `rgba(255, 107, 0, ${1 - i * 0.08})`)
                },
                text: byPrice.map(([k, v]) => `$${v.median_price.toFixed(0)}`),
                textposition: 'outside'
            }], {...getChartLayout(), xaxis: {tickangle: -45}, margin: {b: 120}}, config);

            // ç´ æåˆ¥
            const materials = Object.entries(wallet.material_analysis)
                .filter(([k]) => k !== 'Unknown')
                .sort((a, b) => b[1].count - a[1].count);

            Plotly.newPlot('chart-wallet-material', [{
                type: 'pie',
                labels: materials.map(([k]) => k),
                values: materials.map(([k, v]) => v.count),
                hole: 0.4,
                marker: {
                    colors: ['#795548', '#8D6E63', '#A1887F', '#BCAAA4', '#D7CCC8',
                             '#5D4037', '#4E342E', '#6D4C41', '#3E2723', '#EFEBE9']
                }
            }], {...getChartLayout()}, config);

            // è‰²åˆ¥
            const colors = Object.entries(wallet.color_analysis)
                .filter(([k]) => k !== 'Unknown')
                .sort((a, b) => b[1].count - a[1].count);

            const colorMap = {
                'Black': '#333333', 'Gold': '#FFD700', 'Brown': '#8B4513',
                'Blue': '#1E90FF', 'Pink': '#FFB6C1', 'Red': '#DC143C',
                'Green': '#228B22', 'White': '#F5F5F5', 'Beige': '#F5DEB3',
                'Navy': '#000080', 'Grey': '#808080', 'Bordeaux': '#722F37'
            };

            Plotly.newPlot('chart-wallet-color', [{
                type: 'pie',
                labels: colors.map(([k]) => k),
                values: colors.map(([k, v]) => v.count),
                hole: 0.4,
                marker: {
                    colors: colors.map(([k]) => colorMap[k] || '#999')
                }
            }], {...getChartLayout()}, config);

            // ãƒ¢ãƒ‡ãƒ«Ã—ç´ æãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
            const crossData = wallet.model_material_cross || [];
            const models = [...new Set(crossData.map(d => d.model))];
            const matList = [...new Set(crossData.map(d => d.material))];

            const heatData = models.map(model =>
                matList.map(mat => {
                    const found = crossData.find(c => c.model === model && c.material === mat);
                    return found ? found.count : 0;
                })
            );

            const heatText = models.map(model =>
                matList.map(mat => {
                    const found = crossData.find(c => c.model === model && c.material === mat);
                    return found ? found.count : '';
                })
            );

            Plotly.newPlot('chart-wallet-heatmap', [{
                type: 'heatmap',
                z: heatData,
                x: matList,
                y: models,
                text: heatText,
                texttemplate: '%{text}',
                colorscale: [
                    [0, '#FFF3E0'],
                    [0.25, '#FFB74D'],
                    [0.5, '#FF9800'],
                    [0.75, '#F57C00'],
                    [1, '#E65100']
                ],
                showscale: true,
                hoverongaps: false
            }], {
                ...getChartLayout(),
                xaxis: {tickangle: -45, automargin: true},
                yaxis: {automargin: true},
                margin: {l: 150, b: 100, r: 100}
            }, config);
        }

        function drawPartsCharts() {
            const data = analysisData.parts_analysis;
            const types = Object.keys(data).sort((a, b) => data[b].count - data[a].count);

            Plotly.newPlot('chart-parts-type', [{
                type: 'pie',
                labels: types,
                values: types.map(t => data[t].count),
                hole: 0.4,
                marker: { colors: ['#FF6B00', '#FF9800', '#FFC107', '#4CAF50', '#2196F3', '#9C27B0', '#E91E63'] }
            }], {...getChartLayout()}, config);

            const typesByPrice = [...types].sort((a, b) => data[b].median_price - data[a].median_price);
            Plotly.newPlot('chart-parts-price', [{
                type: 'bar',
                x: typesByPrice,
                y: typesByPrice.map(t => data[t].median_price),
                marker: { color: '#9E9E9E' }
            }], {...getChartLayout(), xaxis: {tickangle: -45}}, config);
        }

        function drawOtherCharts() {
            const detail = analysisData.other_detail_analysis;
            if (!detail) return;

            const data = detail.detail_categories;
            const major = detail.major_categories;
            const subcats = Object.keys(data).sort((a, b) => data[b].count - data[a].count);

            // å¤§ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†å¸ƒï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰
            const majorNames = Object.keys(major).filter(m => m !== 'Exclude/é™¤å¤–');
            const majorCounts = majorNames.map(m => major[m].count);
            Plotly.newPlot('chart-other-major', [{
                type: 'pie',
                labels: majorNames.map(m => m.split('/')[1] || m),
                values: majorCounts,
                textinfo: 'label+value',
                textposition: 'inside',
                marker: {
                    colors: ['#FF6B00', '#9E9E9E', '#4CAF50', '#2196F3', '#E91E63', '#FFC107', '#9C27B0', '#00BCD4', '#673AB7', '#FF5722', '#795548']
                }
            }], getChartLayout(), config);

            // è©³ç´°ã‚«ãƒ†ã‚´ãƒªåˆ¥ï¼ˆä¸Šä½20ï¼‰
            const top20 = subcats.filter(s => !s.includes('é™¤å¤–') && !s.includes('Invalid')).slice(0, 20);
            Plotly.newPlot('chart-other-detail', [{
                type: 'bar',
                x: top20.map(s => data[s].count),
                y: top20.map(s => s.split('/')[1] || s),
                orientation: 'h',
                marker: {
                    color: top20.map((s, i) => {
                        if (s.includes('ãƒãƒƒã‚°') || s.includes('Bag')) return '#E91E63';
                        if (s.includes('ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼') || s.includes('Accessory')) return '#9C27B0';
                        if (s.includes('ã‚¹ã‚«ãƒ¼ãƒ•') || s.includes('Scarf')) return '#FF6B00';
                        if (s.includes('é´') || s.includes('Shoes') || s.includes('Sandal') || s.includes('Sneaker')) return '#3F51B5';
                        if (s.includes('æ™‚è¨ˆ') || s.includes('Watch')) return '#00BCD4';
                        if (s.includes('è¡£') || s.includes('Knit') || s.includes('Jacket') || s.includes('Shirt')) return '#4CAF50';
                        return '#FFC107';
                    })
                },
                text: top20.map(s => data[s].count),
                textposition: 'outside'
            }], {...getChartLayout(), yaxis: {automargin: true}, xaxis: {range: [0, Math.max(...top20.map(s => data[s].count)) * 1.2]}}, config);

            // ä¾¡æ ¼åˆ¥ï¼ˆä¸­å¤®å€¤ãƒ»ä¸Šä½15ï¼‰
            const byPrice = [...subcats]
                .filter(s => !s.includes('é™¤å¤–') && !s.includes('Invalid') && data[s].count >= 3)
                .sort((a, b) => data[b].median_price - data[a].median_price)
                .slice(0, 15);
            Plotly.newPlot('chart-other-price', [{
                type: 'bar',
                x: byPrice.map(s => s.split('/')[1] || s),
                y: byPrice.map(s => data[s].median_price),
                marker: {
                    color: byPrice.map(s => data[s].median_price),
                    colorscale: 'Viridis'
                },
                text: byPrice.map(s => '$' + data[s].median_price.toFixed(0)),
                textposition: 'outside'
            }], {...getChartLayout(), xaxis: {tickangle: -45}, yaxis: {range: [0, Math.max(...byPrice.map(s => data[s].median_price)) * 1.15]}}, config);

            // ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼šå¤§ã‚«ãƒ†ã‚´ãƒªÃ—ä¾¡æ ¼å¸¯
            const priceBands = ['$0-100', '$100-300', '$300-500', '$500-1000', '$1000+'];
            const heatMajors = majorNames.filter(m => major[m].count >= 10);
            // ä¾¡æ ¼å¸¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå¤§ã¾ã‹ãªåˆ†å¸ƒï¼‰
            const heatData = heatMajors.map(m => {
                const subs = Object.keys(data).filter(s => {
                    const majorCat = getMajorCategory(s);
                    return majorCat === m;
                });
                return priceBands.map((band, i) => {
                    let count = 0;
                    subs.forEach(s => {
                        const med = data[s].median_price;
                        if (i === 0 && med < 100) count += data[s].count;
                        else if (i === 1 && med >= 100 && med < 300) count += data[s].count;
                        else if (i === 2 && med >= 300 && med < 500) count += data[s].count;
                        else if (i === 3 && med >= 500 && med < 1000) count += data[s].count;
                        else if (i === 4 && med >= 1000) count += data[s].count;
                    });
                    return count;
                });
            });

            Plotly.newPlot('chart-other-heatmap', [{
                type: 'heatmap',
                x: priceBands,
                y: heatMajors.map(m => m.split('/')[1] || m),
                z: heatData,
                colorscale: 'YlOrRd',
                text: heatData.map(row => row.map(v => v > 0 ? v.toString() : '')),
                texttemplate: '%{text}',
                hovertemplate: '%{y}<br>%{x}: %{z}ä»¶<extra></extra>'
            }], {...getChartLayout(), xaxis: {side: 'top'}}, config);
        }

        function getMajorCategory(cat) {
            const clothing = ['Knitwear/ãƒ‹ãƒƒãƒˆ', 'Jacket/Coat/ã‚¸ãƒ£ã‚±ãƒƒãƒˆãƒ»ã‚³ãƒ¼ãƒˆ', 'Shirt/Blouse/ã‚·ãƒ£ãƒ„ãƒ»ãƒ–ãƒ©ã‚¦ã‚¹',
                            'Dress/ãƒ‰ãƒ¬ã‚¹', 'Pants/Skirt/ãƒ‘ãƒ³ãƒ„ãƒ»ã‚¹ã‚«ãƒ¼ãƒˆ', 'Suit/ã‚¹ãƒ¼ãƒ„', 'Swimwear/æ°´ç€'];
            const shoes = ['Sandals/ã‚µãƒ³ãƒ€ãƒ«', 'Sneakers/ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼', 'Boots/ãƒ–ãƒ¼ãƒ„', 'Loafers/ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼',
                         'Heels/ãƒ’ãƒ¼ãƒ«', 'Flats/ãƒ•ãƒ©ãƒƒãƒˆã‚·ãƒ¥ãƒ¼ã‚º', 'Slippers/Mules/ã‚¹ãƒªãƒƒãƒ‘ãƒ»ãƒŸãƒ¥ãƒ¼ãƒ«',
                         'Espadrilles/ã‚¨ã‚¹ãƒ‘ãƒ‰ãƒªãƒ¼ãƒ¦', 'Shoes-Other/é´ãã®ä»–'];
            const fashion = ['Hat/å¸½å­', 'Gloves/æ‰‹è¢‹', 'Baby/ãƒ™ãƒ“ãƒ¼ç”¨å“', 'Hand Muff/ãƒãƒ³ãƒ‰ãƒãƒ•'];
            const home = ['Beach Towel/ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«', 'Hand Towel/ãƒãƒ³ãƒ‰ã‚¿ã‚ªãƒ«', 'Blanket/ãƒ–ãƒ©ãƒ³ã‚±ãƒƒãƒˆ',
                        'Cushion/ã‚¯ãƒƒã‚·ãƒ§ãƒ³', 'Glassware/ã‚°ãƒ©ã‚¹', 'Paperweight/ãƒšãƒ¼ãƒ‘ãƒ¼ã‚¦ã‚§ã‚¤ãƒˆ',
                        'Frame/ãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ', 'Hanger/ãƒãƒ³ã‚¬ãƒ¼', 'Table Mat/ãƒ†ãƒ¼ãƒ–ãƒ«ãƒãƒƒãƒˆ',
                        'Lacquer Box/æ¼†å™¨ãƒœãƒƒã‚¯ã‚¹', 'Object/ã‚ªãƒ–ã‚¸ã‚§', 'Mouse Pad/ãƒã‚¦ã‚¹ãƒ‘ãƒƒãƒ‰'];
            const tech = ['Mobile Battery/ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼', 'Apple Watch Band/ã‚¢ãƒƒãƒ—ãƒ«ã‚¦ã‚©ãƒƒãƒãƒãƒ³ãƒ‰', 'Tech Accessories/ãƒ†ãƒƒã‚¯ã‚¢ã‚¯ã‚»'];
            const beauty = ['Lipstick/ãƒªãƒƒãƒ—', 'Beauty Tools/ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ„ãƒ¼ãƒ«', 'Amenity/ã‚¢ãƒ¡ãƒ‹ãƒ†ã‚£', 'Comb/ã‚³ãƒ¼ãƒ '];
            const stationery = ['Book/Catalog/æ›¸ç±ãƒ»ã‚«ã‚¿ãƒ­ã‚°', 'Measuring Tape/ãƒ¡ã‚¸ãƒ£ãƒ¼', 'Playing Cards/ãƒˆãƒ©ãƒ³ãƒ—', 'Frisbee/ãƒ•ãƒªã‚¹ãƒ“ãƒ¼', 'Finger Skateboard/ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ã‚¹ã‚±ãƒœãƒ¼'];
            const packaging = ['Bag Accessories/ãƒãƒƒã‚°ç”¨å“', 'Empty Box/ç©ºç®±', 'Dust Bag/Storage/ä¿å­˜è¢‹', 'Shopping Bag/ç´™è¢‹'];
            const watch = ['Watch/æ™‚è¨ˆ', 'Watch Band/æ™‚è¨ˆãƒãƒ³ãƒ‰'];
            const misc = ['Bag/ãƒãƒƒã‚°ï¼ˆãã®ä»–ï¼‰', 'Accessory/ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ï¼ˆãã®ä»–ï¼‰', 'Scarf/ã‚¹ã‚«ãƒ¼ãƒ•ï¼ˆãã®ä»–ï¼‰',
                        'Wallet/é©å°ç‰©ï¼ˆãã®ä»–ï¼‰', 'Strap/ã‚¹ãƒˆãƒ©ãƒƒãƒ—', 'Petit h/ãƒ—ãƒ†ã‚£ã‚¢ãƒƒã‚·ãƒ¥', 'Wine Tools/ãƒ¯ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«', 'Equestrian/é¦¬å…·'];

            if (clothing.includes(cat)) return 'Clothing/è¡£é¡';
            if (shoes.includes(cat)) return 'Shoes/é´';
            if (fashion.includes(cat)) return 'Fashion Accessories/ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³å°ç‰©';
            if (home.includes(cat)) return 'Home/ãƒ›ãƒ¼ãƒ ';
            if (tech.includes(cat)) return 'Tech/ãƒ†ãƒƒã‚¯';
            if (beauty.includes(cat)) return 'Beauty/ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼';
            if (stationery.includes(cat)) return 'Stationery & Games/ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒŠãƒªãƒ¼';
            if (packaging.includes(cat)) return 'Packaging/ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°';
            if (watch.includes(cat)) return 'Watch/æ™‚è¨ˆ';
            if (misc.includes(cat)) return 'Misc Hermes/ã‚¨ãƒ«ãƒ¡ã‚¹é›‘è²¨';
            return 'Unclassified/æœªåˆ†é¡';
        }

        // ===== TABLES =====
        function populateTables() {
            // Category Table
            const catData = analysisData.category_distribution;
            const catTable = document.querySelector('#table-category tbody');
            catTable.innerHTML = Object.keys(catData)
                .sort((a, b) => catData[b].count - catData[a].count)
                .map(cat => `
                    <tr>
                        <td>${catData[cat].icon} ${cat}</td>
                        <td><span class="count-badge">${catData[cat].count.toLocaleString()}</span></td>
                        <td class="price">$${catData[cat].total_sales.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
                        <td class="price">$${catData[cat].avg_price.toFixed(2)}</td>
                        <td class="price">$${catData[cat].median_price.toFixed(2)}</td>
                    </tr>
                `).join('');

            // Scarf Pattern Table
            const patternData = analysisData.scarf_analysis.by_pattern;
            const patternTable = document.querySelector('#table-scarf-pattern tbody');
            patternTable.innerHTML = Object.keys(patternData)
                .sort((a, b) => patternData[b].count - patternData[a].count)
                .map(pattern => `
                    <tr>
                        <td>${pattern}</td>
                        <td><span class="count-badge">${patternData[pattern].count}</span></td>
                        <td class="price">$${patternData[pattern].avg_price.toFixed(2)}</td>
                        <td class="price">$${patternData[pattern].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://www.ebay.com/sch/i.html?_nkw=hermes+${encodeURIComponent(pattern)}&LH_Sold=1" target="_blank" class="search-link">eBay</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_ebay_0">
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(pattern)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_1">
                        </td>
                    </tr>
                `).join('');

            // Animal Pattern Table
            const animalData = analysisData.animal_pattern_analysis;
            const animalTable = document.querySelector('#table-animal-pattern tbody');
            if (animalTable) {
                const animalKeywords = {
                    'Horse/é¦¬': 'é¦¬', 'Chasse en Inde': 'ã‚¤ãƒ³ãƒ‰ç‹©ã‚Š', 'Cat/çŒ«': 'çŒ«', 'Jungle Love': 'ã‚¸ãƒ£ãƒ³ã‚°ãƒ«ãƒ©ãƒ–',
                    'Bird/é³¥': 'é³¥', 'Dog/çŠ¬': 'çŠ¬', 'Les Leopards': 'ãƒ¬ã‚ªãƒ‘ãƒ¼ãƒ‰', 'Tiger/è™': 'è™',
                    'Zebra/ZÃ¨bre': 'ã‚¼ãƒ–ãƒ©', 'Elephant/è±¡': 'è±¡', 'Fish/é­š': 'é­š', 'Wildlife': 'ãƒ¯ã‚¤ãƒ«ãƒ‰ãƒ©ã‚¤ãƒ•',
                    'Butterfly/è¶': 'è¶', 'Faune et Flore': 'å‹•æ¤ç‰©', 'Lion': 'ãƒ©ã‚¤ã‚ªãƒ³'
                };
                animalTable.innerHTML = Object.keys(animalData)
                    .sort((a, b) => animalData[b].count - animalData[a].count)
                    .map(animal => `
                        <tr>
                            <td>${animal}</td>
                            <td><span class="count-badge">${animalData[animal].count}</span></td>
                            <td class="price">$${animalData[animal].avg_price.toFixed(2)}</td>
                            <td class="price">$${animalData[animal].median_price.toFixed(2)}</td>
                            <td>
                                <a href="https://www.ebay.com/sch/i.html?_nkw=hermes+scarf+${encodeURIComponent(animal.split('/')[0])}&LH_Sold=1" target="_blank" class="search-link">eBay</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_ebay_2">
                                <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20ã‚¹ã‚«ãƒ¼ãƒ•%20${encodeURIComponent(animalKeywords[animal] || animal)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_3">
                            </td>
                        </tr>
                    `).join('');
            }

            // Bag Model Table
            const bagData = analysisData.bag_analysis.by_model;
            const bagTable = document.querySelector('#table-bag-model tbody');
            bagTable.innerHTML = Object.keys(bagData)
                .sort((a, b) => bagData[b].count - bagData[a].count)
                .map(model => `
                    <tr>
                        <td>${model}</td>
                        <td><span class="count-badge">${bagData[model].count}</span></td>
                        <td class="price">$${bagData[model].avg_price.toFixed(2)}</td>
                        <td class="price">$${bagData[model].median_price.toFixed(2)}</td>
                        <td class="price">$${bagData[model].min_price.toFixed(2)}</td>
                        <td class="price">$${bagData[model].max_price.toFixed(2)}</td>
                        <td>
                            <a href="https://www.ebay.com/sch/i.html?_nkw=hermes+${encodeURIComponent(model)}&LH_Sold=1" target="_blank" class="search-link">eBay</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_ebay_4">
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(model)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_5">
                        </td>
                    </tr>
                `).join('');

            // Accessory Table (æ±ç”¨åˆ†é¡)
            const accData = analysisData.accessory_analysis;
            const accTable = document.querySelector('#table-accessory tbody');
            accTable.innerHTML = Object.keys(accData)
                .sort((a, b) => accData[b].count - accData[a].count)
                .map(type => `
                    <tr>
                        <td>${type}</td>
                        <td><span class="count-badge">${accData[type].count}</span></td>
                        <td class="price">$${accData[type].avg_price.toFixed(2)}</td>
                        <td class="price">$${accData[type].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(type)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_6">
                        </td>
                    </tr>
                `).join('');

            // Accessory Detail Table (è©³ç´°åˆ†é¡)
            const accDetail = analysisData.accessory_detail;
            if (accDetail) {
                const typeKeywords = {
                    'Bangle - Enamel': 'ãƒãƒ³ã‚°ãƒ« ã‚¨ãƒŠãƒ¡ãƒ«', 'Bangle': 'ãƒãƒ³ã‚°ãƒ«', 'Leather Bracelet': 'ãƒ¬ã‚¶ãƒ¼ãƒ–ãƒ¬ã‚¹ãƒ¬ãƒƒãƒˆ',
                    'Clic Clac': 'ã‚¯ãƒªãƒƒã‚¯ã‚¯ãƒ©ãƒƒã‚¯', 'Clic H': 'ã‚¯ãƒªãƒƒã‚¯H', 'Collier de Chien': 'ã‚³ãƒªã‚¨ãƒ‰ã‚·ã‚¢ãƒ³',
                    'Kelly Double Tour': 'ã‚±ãƒªãƒ¼ãƒ‰ã‚¥ãƒ–ãƒ«ãƒˆã‚¥ãƒ¼ãƒ«', 'Hapi': 'ã‚¢ãƒ”',
                    'Scarf Ring (Other)': 'ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚°', "Scarf Ring - Chaine d'Ancre": 'ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚° ã‚·ã‚§ãƒ¼ãƒŒãƒ€ãƒ³ã‚¯ãƒ«',
                    'Scarf Ring - Gold': 'ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚° ã‚´ãƒ¼ãƒ«ãƒ‰', 'Scarf Ring - Cosmos': 'ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚° ã‚³ã‚¹ãƒ¢ã‚¹',
                    'Cadena/Padlock': 'ã‚«ãƒ‡ãƒŠ', 'Charm': 'ãƒãƒ£ãƒ¼ãƒ ', 'Charm - Rodeo': 'ãƒ­ãƒ‡ã‚ª ãƒãƒ£ãƒ¼ãƒ ',
                    'Belt': 'ãƒ™ãƒ«ãƒˆ', 'Belt - Constance': 'ã‚³ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ãƒ™ãƒ«ãƒˆ', 'Belt - H Buckle': 'Hãƒ™ãƒ«ãƒˆ',
                    'Necklace': 'ãƒãƒƒã‚¯ãƒ¬ã‚¹', 'Chain Necklace': 'ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒã‚¯ãƒ¬ã‚¹', 'Earrings': 'ã‚¤ãƒ¤ãƒªãƒ³ã‚°',
                    'Ring': 'ãƒªãƒ³ã‚°', 'Brooch/Pin': 'ãƒ–ãƒ­ãƒ¼ãƒ', 'Tie - Silk': 'ãƒã‚¯ã‚¿ã‚¤ ã‚·ãƒ«ã‚¯', 'Tie': 'ãƒã‚¯ã‚¿ã‚¤',
                    'Cufflinks': 'ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹', 'Glove Holder/Filou': 'ã‚°ãƒ­ãƒ¼ãƒ–ãƒ›ãƒ«ãƒ€ãƒ¼'
                };

                const accDetailTable = document.querySelector('#table-accessory-detail tbody');
                if (accDetailTable) {
                    accDetailTable.innerHTML = Object.entries(accDetail.item_type_analysis)
                        .sort((a, b) => b[1].count - a[1].count)
                        .map(([type, data]) => {
                            const jpType = typeKeywords[type] || type;
                            return `
                            <tr>
                                <td><strong>${type}</strong></td>
                                <td><span class="count-badge">${data.count}</span></td>
                                <td class="price">$${data.avg_price.toFixed(2)}</td>
                                <td class="price">$${data.median_price.toFixed(2)}</td>
                                <td class="price">$${data.min_price.toFixed(2)}</td>
                                <td class="price">$${data.max_price.toFixed(2)}</td>
                                <td>
                                    <a href="https://www.ebay.com/sch/i.html?_nkw=hermes+${encodeURIComponent(type)}&LH_Sold=1" target="_blank" class="search-link">eBay</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_ebay_7">
                                    <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(jpType)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_8">
                                </td>
                            </tr>
                        `}).join('');
                }

                // Accessory Cross Table (ã‚¿ã‚¤ãƒ—Ã—ç´ æ)
                const accCrossTable = document.querySelector('#table-accessory-cross tbody');
                if (accCrossTable && accDetail.type_material_cross) {
                    const materialKeywords = {
                        'Enamel': 'ã‚¨ãƒŠãƒ¡ãƒ«', 'Leather': 'ãƒ¬ã‚¶ãƒ¼', 'Silk': 'ã‚·ãƒ«ã‚¯', 'Silver': 'ã‚·ãƒ«ãƒãƒ¼',
                        'Gold/GP': 'ã‚´ãƒ¼ãƒ«ãƒ‰', 'Gold Plated': 'ã‚´ãƒ¼ãƒ«ãƒ‰ãƒ—ãƒ¬ãƒ¼ãƒˆ', '18K Gold': '18K',
                        'Horn/Buffalo': 'ãƒ›ãƒ¼ãƒ³'
                    };
                    accCrossTable.innerHTML = accDetail.type_material_cross
                        .map(item => {
                            const jpType = typeKeywords[item.type] || item.type;
                            const jpMat = materialKeywords[item.material] || item.material;
                            return `
                            <tr>
                                <td>${item.type}</td>
                                <td>${item.material}</td>
                                <td><span class="count-badge">${item.count}</span></td>
                                <td class="price">$${item.median.toFixed(2)}</td>
                                <td>
                                    <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(jpType)}%20${encodeURIComponent(jpMat)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_9">
                                </td>
                            </tr>
                        `}).join('');
                }
            }

            // Leather Table (æ±ç”¨åˆ†é¡)
            const leatherData = analysisData.leather_goods_analysis;
            const leatherTable = document.querySelector('#table-leather tbody');
            leatherTable.innerHTML = Object.keys(leatherData)
                .sort((a, b) => leatherData[b].count - leatherData[a].count)
                .map(type => `
                    <tr>
                        <td>${type}</td>
                        <td><span class="count-badge">${leatherData[type].count}</span></td>
                        <td class="price">$${leatherData[type].avg_price.toFixed(2)}</td>
                        <td class="price">$${leatherData[type].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(type)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_10">
                        </td>
                    </tr>
                `).join('');

            // Wallet Model Table (ä¸»è¦ãƒ¢ãƒ‡ãƒ«è©³ç´°)
            const wallet = analysisData.wallet_analysis;
            if (wallet) {
                const walletModelTable = document.querySelector('#table-wallet-model tbody');
                if (walletModelTable) {
                    const modelKeywords = {
                        'Bearn': 'ãƒ™ã‚¢ãƒ³', 'Bearn Soufflet': 'ãƒ™ã‚¢ãƒ³ã‚¹ãƒ•ãƒ¬', 'Dogon': 'ãƒ‰ã‚´ãƒ³',
                        'Azap': 'ã‚¢ã‚¶ãƒƒãƒ—', "Azap Silk'in": 'ã‚¢ã‚¶ãƒƒãƒ—ã‚·ãƒ«ã‚¯ã‚¤ãƒ³', 'Azap Compact': 'ã‚¢ã‚¶ãƒƒãƒ—ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ',
                        'Bastia': 'ãƒã‚¹ãƒ†ã‚£ã‚¢', 'Calvi': 'ã‚«ãƒ«ãƒ´ã‚£', 'Calvi Duo': 'ã‚«ãƒ«ãƒ´ã‚£ãƒ‡ãƒ¥ã‚ª',
                        'Kelly Wallet/Pochette': 'ã‚±ãƒªãƒ¼ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ', 'Constance Wallet': 'ã‚³ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è²¡å¸ƒ',
                        'Citizen Twill': 'ã‚·ãƒã‚ºãƒ³ãƒ„ã‚¤ãƒ«', 'Tarmac': 'ã‚¿ãƒ«ãƒãƒƒã‚¯', 'MC2': 'MC2',
                        'Card Holder/Case': 'ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹', 'Coin Purse/Case': 'ã‚³ã‚¤ãƒ³ã‚±ãƒ¼ã‚¹',
                        'Key Holder/Case': 'ã‚­ãƒ¼ã‚±ãƒ¼ã‚¹', 'Long Wallet': 'é•·è²¡å¸ƒ', 'Passport Holder': 'ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚±ãƒ¼ã‚¹'
                    };
                    walletModelTable.innerHTML = Object.entries(wallet.item_type_analysis)
                        .sort((a, b) => b[1].count - a[1].count)
                        .map(([model, data]) => {
                            const materials = wallet.model_detail?.[model]?.materials;
                            const topMaterials = materials ? Object.entries(materials).slice(0, 3).map(([m, c]) => `${m}(${c})`).join(', ') : '-';
                            const jpModel = modelKeywords[model] || model;
                            return `
                            <tr>
                                <td><strong>${model}</strong></td>
                                <td><span class="count-badge">${data.count}</span></td>
                                <td class="price">$${data.avg_price.toFixed(2)}</td>
                                <td class="price">$${data.median_price.toFixed(2)}</td>
                                <td class="price">$${data.min_price.toFixed(2)}</td>
                                <td class="price">$${data.max_price.toFixed(2)}</td>
                                <td style="font-size: 11px;">${topMaterials}</td>
                                <td>
                                    <a href="https://www.ebay.com/sch/i.html?_nkw=hermes+${encodeURIComponent(model)}&LH_Sold=1" target="_blank" class="search-link">eBay</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_ebay_11">
                                    <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(jpModel)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_12">
                                </td>
                            </tr>
                        `}).join('');
                }

                // Wallet Cross Table (ãƒ¢ãƒ‡ãƒ«Ã—ç´ æ)
                const walletCrossTable = document.querySelector('#table-wallet-cross tbody');
                if (walletCrossTable && wallet.model_material_cross) {
                    const modelKeywords = {
                        'Bearn': 'ãƒ™ã‚¢ãƒ³', 'Dogon': 'ãƒ‰ã‚´ãƒ³', "Azap Silk'in": 'ã‚¢ã‚¶ãƒƒãƒ—ã‚·ãƒ«ã‚¯ã‚¤ãƒ³',
                        'Bastia': 'ãƒã‚¹ãƒ†ã‚£ã‚¢', 'Calvi': 'ã‚«ãƒ«ãƒ´ã‚£', 'Coin Purse/Case': 'ã‚³ã‚¤ãƒ³ã‚±ãƒ¼ã‚¹',
                        'Card Holder/Case': 'ã‚«ãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹', 'Key Holder/Case': 'ã‚­ãƒ¼ã‚±ãƒ¼ã‚¹',
                        'Long Wallet': 'é•·è²¡å¸ƒ', 'Wallet (Other)': 'è²¡å¸ƒ', 'Azap Compact': 'ã‚¢ã‚¶ãƒƒãƒ—ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ',
                        'Purse': 'å°éŠ­å…¥ã‚Œ'
                    };
                    const materialKeywords = {
                        'Epsom': 'ã‚¨ãƒ—ã‚½ãƒ³', 'Togo': 'ãƒˆã‚´', 'Clemence': 'ã‚¯ãƒ¬ãƒãƒ³ã‚¹', 'Swift': 'ã‚¹ã‚¤ãƒ•ãƒˆ',
                        'Box Calf': 'ãƒœãƒƒã‚¯ã‚¹ã‚«ãƒ¼ãƒ•', 'Chevre/Mysore': 'ã‚·ã‚§ãƒ¼ãƒ–ãƒ«', 'Canvas/Toile': 'ã‚­ãƒ£ãƒ³ãƒã‚¹',
                        'Leather': 'ãƒ¬ã‚¶ãƒ¼', 'Silk': 'ã‚·ãƒ«ã‚¯'
                    };
                    walletCrossTable.innerHTML = wallet.model_material_cross
                        .map(item => {
                            const jpModel = modelKeywords[item.model] || item.model;
                            const jpMaterial = materialKeywords[item.material] || item.material;
                            return `
                            <tr>
                                <td>${item.model}</td>
                                <td>${item.material}</td>
                                <td><span class="count-badge">${item.count}</span></td>
                                <td class="price">$${item.median.toFixed(2)}</td>
                                <td>
                                    <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(jpModel)}%20${encodeURIComponent(jpMaterial)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_13">
                                </td>
                            </tr>
                        `}).join('');
                }
            }

            // Parts Table
            const partsData = analysisData.parts_analysis;
            const partsTable = document.querySelector('#table-parts tbody');
            partsTable.innerHTML = Object.keys(partsData)
                .sort((a, b) => partsData[b].count - partsData[a].count)
                .map(type => `
                    <tr>
                        <td>${type}</td>
                        <td><span class="count-badge">${partsData[type].count}</span></td>
                        <td class="price">$${partsData[type].avg_price.toFixed(2)}</td>
                        <td class="price">$${partsData[type].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(type)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_14">
                        </td>
                    </tr>
                `).join('');

            // Bangle Material Table
            const bangleData = analysisData.bangle_by_material;
            const bangleTable = document.querySelector('#table-bangle-material tbody');
            bangleTable.innerHTML = Object.keys(bangleData)
                .sort((a, b) => bangleData[b].count - bangleData[a].count)
                .map(mat => `
                    <tr>
                        <td>${mat}</td>
                        <td><span class="count-badge">${bangleData[mat].count}</span></td>
                        <td class="price">$${bangleData[mat].avg_price.toFixed(2)}</td>
                        <td class="price">$${bangleData[mat].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20ãƒãƒ³ã‚°ãƒ«%20${encodeURIComponent(mat)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_15">
                        </td>
                    </tr>
                `).join('');

            // Scarf Ring Table
            const ringData = analysisData.scarf_ring_by_model;
            const ringTable = document.querySelector('#table-scarf-ring tbody');
            ringTable.innerHTML = Object.keys(ringData)
                .sort((a, b) => ringData[b].count - ringData[a].count)
                .map(model => `
                    <tr>
                        <td>${model}</td>
                        <td><span class="count-badge">${ringData[model].count}</span></td>
                        <td class="price">$${ringData[model].avg_price.toFixed(2)}</td>
                        <td class="price">$${ringData[model].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20ã‚¹ã‚«ãƒ¼ãƒ•ãƒªãƒ³ã‚°%20${encodeURIComponent(model.replace('/Chaine', ''))}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_16">
                        </td>
                    </tr>
                `).join('');

            // Tie Pattern Table
            const tieData = analysisData.tie_by_pattern;
            const tieTable = document.querySelector('#table-tie-pattern tbody');
            tieTable.innerHTML = Object.keys(tieData)
                .sort((a, b) => tieData[b].count - tieData[a].count)
                .map(pattern => {
                    const jpPattern = pattern.replace('Animal/å‹•ç‰©', 'å‹•ç‰©').replace('Horse/é¦¬', 'é¦¬').replace('Geometric/å¹¾ä½•å­¦', 'å¹¾ä½•å­¦').replace('Chain/é–', 'é–').replace('Rope/Belt', 'ãƒ™ãƒ«ãƒˆ').replace('Floral/èŠ±', 'èŠ±').replace('H Logo', 'H');
                    return `
                    <tr>
                        <td>${pattern}</td>
                        <td><span class="count-badge">${tieData[pattern].count}</span></td>
                        <td class="price">$${tieData[pattern].avg_price.toFixed(2)}</td>
                        <td class="price">$${tieData[pattern].median_price.toFixed(2)}</td>
                        <td>
                            <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20ãƒã‚¯ã‚¿ã‚¤%20${encodeURIComponent(jpPattern)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_17">
                        </td>
                    </tr>
                `}).join('');

            // Other Detail Table - æ–°ã—ã„ç´°åˆ†åŒ–ãƒ‡ãƒ¼ã‚¿
            const otherDetailData = analysisData.other_detail_analysis;
            if (otherDetailData) {
                const otherData = otherDetailData.detail_categories;
                const otherTable = document.querySelector('#table-other-detail tbody');

                // ã‚«ãƒ†ã‚´ãƒªâ†’ãƒ¡ãƒ«ã‚«ãƒªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒãƒ”ãƒ³ã‚°
                const otherKeywords = {
                    'Accessory/ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ï¼ˆãã®ä»–ï¼‰': 'ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼',
                    'Bag/ãƒãƒƒã‚°ï¼ˆãã®ä»–ï¼‰': 'ãƒãƒƒã‚°',
                    'Scarf/ã‚¹ã‚«ãƒ¼ãƒ•ï¼ˆãã®ä»–ï¼‰': 'ã‚¹ã‚«ãƒ¼ãƒ•',
                    'Wallet/é©å°ç‰©ï¼ˆãã®ä»–ï¼‰': 'è²¡å¸ƒ',
                    'Knitwear/ãƒ‹ãƒƒãƒˆ': 'ãƒ‹ãƒƒãƒˆ',
                    'Watch/æ™‚è¨ˆ': 'æ™‚è¨ˆ',
                    'Playing Cards/ãƒˆãƒ©ãƒ³ãƒ—': 'ãƒˆãƒ©ãƒ³ãƒ—',
                    'Sandals/ã‚µãƒ³ãƒ€ãƒ«': 'ã‚µãƒ³ãƒ€ãƒ« ã‚ªãƒ©ãƒ³',
                    'Hand Towel/ãƒãƒ³ãƒ‰ã‚¿ã‚ªãƒ«': 'ã‚¿ã‚ªãƒ«',
                    'Beach Towel/ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«': 'ãƒ“ãƒ¼ãƒã‚¿ã‚ªãƒ«',
                    'Sneakers/ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼': 'ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼',
                    'Hat/å¸½å­': 'å¸½å­',
                    'Shoes-Other/é´ãã®ä»–': 'é´',
                    'Shirt/Blouse/ã‚·ãƒ£ãƒ„ãƒ»ãƒ–ãƒ©ã‚¦ã‚¹': 'ã‚·ãƒ£ãƒ„',
                    'Gloves/æ‰‹è¢‹': 'æ‰‹è¢‹',
                    'Frame/ãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ': 'ãƒ•ã‚©ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ',
                    'Jacket/Coat/ã‚¸ãƒ£ã‚±ãƒƒãƒˆãƒ»ã‚³ãƒ¼ãƒˆ': 'ã‚¸ãƒ£ã‚±ãƒƒãƒˆ',
                    'Glassware/ã‚°ãƒ©ã‚¹': 'ã‚°ãƒ©ã‚¹',
                    'Strap/ã‚¹ãƒˆãƒ©ãƒƒãƒ—': 'ã‚·ãƒ§ãƒ«ãƒ€ãƒ¼ã‚¹ãƒˆãƒ©ãƒƒãƒ—',
                    'Equestrian/é¦¬å…·': 'é¦¬å…·',
                    'Loafers/ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼': 'ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ¼',
                    'Comb/ã‚³ãƒ¼ãƒ ': 'ã‚³ãƒ¼ãƒ ',
                    'Suit/ã‚¹ãƒ¼ãƒ„': 'ã‚¹ãƒ¼ãƒ„',
                    'Pants/Skirt/ãƒ‘ãƒ³ãƒ„ãƒ»ã‚¹ã‚«ãƒ¼ãƒˆ': 'ãƒ‘ãƒ³ãƒ„',
                    'Petit h/ãƒ—ãƒ†ã‚£ã‚¢ãƒƒã‚·ãƒ¥': 'ãƒ—ãƒ†ã‚£ã‚¢ãƒƒã‚·ãƒ¥',
                    'Object/ã‚ªãƒ–ã‚¸ã‚§': 'ã‚ªãƒ–ã‚¸ã‚§',
                    'Wine Tools/ãƒ¯ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«': 'ã‚½ãƒ ãƒªã‚¨ãƒŠã‚¤ãƒ•',
                    'Mobile Battery/ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼': 'ãƒ¢ãƒã‚¤ãƒ«ãƒãƒƒãƒ†ãƒªãƒ¼',
                    'Baby/ãƒ™ãƒ“ãƒ¼ç”¨å“': 'ãƒ™ãƒ“ãƒ¼'
                };

                otherTable.innerHTML = Object.keys(otherData)
                    .filter(cat => !cat.includes('é™¤å¤–') && !cat.includes('Invalid'))
                    .sort((a, b) => otherData[b].count - otherData[a].count)
                    .map(cat => {
                        const d = otherData[cat];
                        const jpKeyword = otherKeywords[cat] || cat.split('/')[1] || cat;
                        const majorCat = getMajorCategory(cat);
                        const majorColor = {
                            'Misc Hermes/ã‚¨ãƒ«ãƒ¡ã‚¹é›‘è²¨': '#FF6B00',
                            'Clothing/è¡£é¡': '#4CAF50',
                            'Shoes/é´': '#3F51B5',
                            'Home/ãƒ›ãƒ¼ãƒ ': '#9C27B0',
                            'Watch/æ™‚è¨ˆ': '#00BCD4',
                            'Stationery & Games/ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒŠãƒªãƒ¼': '#FFC107',
                            'Fashion Accessories/ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³å°ç‰©': '#E91E63',
                            'Beauty/ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼': '#FF5722',
                            'Tech/ãƒ†ãƒƒã‚¯': '#607D8B',
                            'Packaging/ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°': '#795548'
                        }[majorCat] || '#9E9E9E';

                        return `
                        <tr>
                            <td><span style="background: ${majorColor}; color: #fff; padding: 2px 8px; border-radius: 10px; font-size: 11px;">${cat.split('/')[1] || cat}</span></td>
                            <td><span class="count-badge">${d.count}</span></td>
                            <td class="price">$${d.median_price.toFixed(2)}</td>
                            <td class="price">$${d.avg_price.toFixed(2)}</td>
                            <td class="price">$${d.max_price.toFixed(2)}</td>
                            <td>
                                <a href="https://jp.mercari.com/search?keyword=ã‚¨ãƒ«ãƒ¡ã‚¹%20${encodeURIComponent(jpKeyword)}&status=on_sale" target="_blank" class="search-link">ãƒ¡ãƒ«ã‚«ãƒª</a>
                            <input type="checkbox" class="search-checkbox" data-id="hermes_mercari_18">
                            </td>
                        </tr>
                    `}).join('');

                // Other Cross Table - å¤§ã‚«ãƒ†ã‚´ãƒªÃ—ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª
                const crossTable = document.querySelector('#table-other-cross tbody');
                if (crossTable) {
                    const major = otherDetailData.major_categories;
                    let crossRows = [];
                    Object.keys(major).filter(m => m !== 'Exclude/é™¤å¤–').forEach(majorCat => {
                        const subs = Object.keys(otherData)
                            .filter(cat => getMajorCategory(cat) === majorCat)
                            .sort((a, b) => otherData[b].count - otherData[a].count);
                        subs.forEach((sub, i) => {
                            const d = otherData[sub];
                            crossRows.push({
                                major: i === 0 ? majorCat.split('/')[1] || majorCat : '',
                                majorFull: majorCat,
                                sub: sub.split('/')[1] || sub,
                                count: d.count,
                                median: d.median_price,
                                rowspan: i === 0 ? subs.length : 0
                            });
                        });
                    });

                    crossTable.innerHTML = crossRows.map(r => `
                        <tr>
                            ${r.rowspan > 0 ? `<td rowspan="${r.rowspan}" style="font-weight: bold; background: var(--bg-card-hover);">${r.major}</td>` : ''}
                            <td>${r.sub}</td>
                            <td><span class="count-badge">${r.count}</span></td>
                            <td class="price">$${r.median.toFixed(2)}</td>
                        </tr>
                    `).join('');
                }
            }
        }

        // ===== TABLE UTILITIES =====
        function filterTable(tableId, query) {
            const table = document.getElementById(tableId);
            const rows = table.querySelectorAll('tbody tr');
            query = query.toLowerCase();

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query) ? '' : 'none';
            });
        }

        function sortTable(tableId, colIndex) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            const isNumeric = colIndex > 0;
            rows.sort((a, b) => {
                let aVal = a.cells[colIndex].textContent.trim();
                let bVal = b.cells[colIndex].textContent.trim();

                if (isNumeric) {
                    aVal = parseFloat(aVal.replace(/[$,]/g, '')) || 0;
                    bVal = parseFloat(bVal.replace(/[$,]/g, '')) || 0;
                    return bVal - aVal;
                }
                return aVal.localeCompare(bVal);
            });

            rows.forEach(row => tbody.appendChild(row));
        }

        // ===== SEARCH FILTER =====
        function setupSearchFilters() {
            // è²¡å¸ƒãƒ¢ãƒ‡ãƒ«æ¤œç´¢
            const searchInput = document.getElementById('search-wallet-model');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toLowerCase();
                    const rows = document.querySelectorAll('#table-wallet-model tbody tr');
                    rows.forEach(row => {
                        const text = row.textContent.toLowerCase();
                        row.style.display = text.includes(term) ? '' : 'none';
                    });
                });
            }

            // ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã‚¿ã‚¤ãƒ—æ¤œç´¢
            const accSearchInput = document.getElementById('search-accessory-type');
            if (accSearchInput) {
                accSearchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toLowerCase();
                    const rows = document.querySelectorAll('#table-accessory-detail tbody tr');
                    rows.forEach(row => {
                        const text = row.textContent.toLowerCase();
                        row.style.display = text.includes(term) ? '' : 'none';
                    });
                });
            }

            // ãã®ä»–ã‚«ãƒ†ã‚´ãƒªæ¤œç´¢
            const otherSearchInput = document.getElementById('search-other-category');
            if (otherSearchInput) {
                otherSearchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toLowerCase();
                    const rows = document.querySelectorAll('#table-other-detail tbody tr');
                    rows.forEach(row => {
                        const text = row.textContent.toLowerCase();
                        row.style.display = text.includes(term) ? '' : 'none';
                    });
                });
            }
        }

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            drawAllCharts();
            setupSearchFilters();
        });
    
        // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®localStorageç®¡ç†
        function initCheckboxes() {
            document.addEventListener('DOMContentLoaded', function() {
                // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’å¾©å…ƒ
                const checkboxes = document.querySelectorAll('.search-checkbox');
                checkboxes.forEach(checkbox => {
                    const checkboxId = checkbox.getAttribute('data-id');
                    if (checkboxId) {
                        const isChecked = localStorage.getItem(`checkbox_${checkboxId}`) === 'true';
                        checkbox.checked = isChecked;
                    }

                    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚’ç›£è¦–
                    checkbox.addEventListener('change', function() {
                        const checkboxId = this.getAttribute('data-id');
                        if (checkboxId) {
                            localStorage.setItem(`checkbox_${checkboxId}`, this.checked);
                        }
                    });
                });
            });
        }

        // åˆæœŸåŒ–é–¢æ•°ã‚’å‘¼ã³å‡ºã—
        initCheckboxes();
</script>
</body>
</html>
